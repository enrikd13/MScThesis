<!DOCTYPE html>
<!-- saved from url=(0078)https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386 -->
<html xmlns:m="http://www.w3.org/1998/Math/MathML" lang="en" style="display: none" id="simpleViewer"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Transforming malicious code to ROP gadgets for antivirus evasion</title>
        







    
    <meta name="dc.identifier" content="10.1049/iet-ifs.2018.5386">

<meta http-equiv="X-UA-Compatible" content="IE=EDGE">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link rel="stylesheet" type="text/css" href="./Transforming malicious code to ROP gadgetsfor antivirus evasion_files/shared.css">
        
            <link rel="stylesheet" type="text/css" href="./Transforming malicious code to ROP gadgetsfor antivirus evasion_files/pdf-renderer.css">
        
    

<style rel="text/css">
    @import url("/templates/jsp/cloudReader/css/d.css");
</style>
<link href="./Transforming malicious code to ROP gadgetsfor antivirus evasion_files/css" rel="stylesheet" media="all" onload="this.media=&#39;all&#39;">
<script type="text/javascript">
    window.LIT = window.LIT || {};
    LIT.Reader = LIT.Reader || {};
    LIT.Reader.LogEnabled = false;
    window.READER_OFFLINE = navigator && navigator.onLine === false;
    
    var verifyOfflineMode = function () {
        
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function () {
            window.READER_OFFLINE = xhr.readyState === 4 && xhr.status !== 200;
            if (window.READER_OFFLINE && true) {
                
                let mathjaxUrl = "/cloud-reader/dist/scripts/mathjax/MathJax.min.js";
                
                    mathjaxUrl = "/cloud-reader/dist/MathJax.min.js";
                
                fetch(mathjaxUrl).then(function (res) {
                    res.text().then(function (txt) {
                        LIT.Reader.MathJaxUrl = window.URL.createObjectURL(new Blob([txt], {'type': 'text/javascript'}));
                    })
                })
            }
        };
        xhr.open("HEAD", "/templates/jsp/images/singlePixel.gif?t=" + new Date().getTime());
        
        xhr.setRequestHeader("Cache-Control", "no-cache,must-revalidate,max-age=0");
        xhr.setRequestHeader("Pragma", "no-cache");
        xhr.send();
    };
    
    verifyOfflineMode();

    var path = (window.location && window.location.pathname) ? window.location.pathname : '';

    
    path = path.replace(/(.*)\/.*\.[x]?html$/, "$1");

    
    path = path.charAt(path.length - 1) === '/'
        ? path.substr(0, path.length - 1)
        : path;

    
    var readerResourcesPath = "/cloud-reader/dist";

    var HTTPServerRootFolder =
        window.location ? (
            window.location.protocol
            + "//"
            + window.location.hostname
            + (window.location.port ? (':' + window.location.port) : '')
            + readerResourcesPath
        ) : ''
    ;
</script>
        
            







<script type="text/javascript">
    
    var eReaderPage = true;
    var readerAtmEventName = "ereader.fullview";
    var readerAtmEventData = {"eventData":{"site":{"ip":"141.43.216.229","environment":"LIVE","website":"ietresearch.onlinelibrary.wiley.com","websiteCode":"ietresearch","serverDate":"2022-02-18"},"identities":[{"type":"InstitutionUser","uuid":"6a9ad942-4e9a-4a76-a1c6-f719b13d8e45","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"EAL00000122637"}]},{"type":"ReferrerUser","uuid":"5a52f27c-b57e-4a2d-8de6-c4f2e0fa8465"},{"type":"InstitutionUser","uuid":"1ae7bb3f-1b73-4351-ae2d-7ac93d314137","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"EAL00000018713"}]},{"type":"InstitutionUser","uuid":"58cbd8e6-3c5d-4fc0-ac26-57c4792d2c4b","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"EALWB000204"}]},{"type":"SmartGroupUser","uuid":"756fc162-8722-461f-a077-ebffec4f4fae"},{"type":"SmartGroupUser","uuid":"cf9c85b9-7f3b-4309-aeaa-c41669cabe3b"},{"type":"SmartGroupUser","uuid":"db8b8d10-1aed-4809-b3ee-70938c569014"},{"type":"InstitutionUser","uuid":"596cc767-d784-4dd2-b3d5-91243c5885d1","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"TEMPBFJPEN_1977-1998"}]},{"type":"InstitutionUser","uuid":"010f5cd6-dcd6-4a3c-a964-1265aae44e0c","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"BRANDE135S"}]},{"type":"ReferrerUser","uuid":"6401b279-b825-4f41-a389-04e29feb967f"},{"type":"InstitutionUser","uuid":"bd4ce257-51c3-46ed-bb55-27d63aa64085","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"PLMSBACKFILE"}]},{"type":"SmartGroupUser","uuid":"77da7ca2-c9f3-4f94-9737-922e1d15b7d9"},{"type":"BasicGroup","uuid":"2f6750d5-f13f-4356-939b-048ac1423e64"},{"type":"SmartGroupUser","uuid":"ab743440-628f-4964-9216-9983ad3beadf"},{"type":"SmartGroupUser","uuid":"a4187e00-f28e-4754-9a0f-1eb306fb0679"},{"type":"InstitutionUser","uuid":"69c4765e-bc5f-4d88-81ea-025365b23800","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"GP#DFG"}]},{"type":"SmartGroupUser","uuid":"b238ab85-6bb4-49e4-84ca-a0d9f3ee5a35"},{"type":"SmartGroupUser","uuid":"dabe0846-17da-48da-b0b3-8ab2310da5a0"},{"type":"BasicGroup","uuid":"32489ba7-57d6-43ed-b717-a0de5ed5ca0e"},{"type":"SmartGroupUser","uuid":"eabce89b-65c2-4a09-ab7c-bd2b3fea2f10"},{"type":"BasicGroup","uuid":"b2f59a00-e5f8-40f1-8e75-8c7dd6bce0ba"},{"type":"SmartGroupUser","uuid":"da88d808-3f7b-4bde-9210-10862b6d121b"},{"type":"InstitutionUser","uuid":"793ac739-ad4b-4ec4-b09e-1d797fd55c0b","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"DBTEMPE766"}]},{"type":"InstitutionUser","uuid":"20be2189-ab69-48e7-bd86-a1ab6011acb2","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"P#FAK"}]},{"type":"RegionUser","uuid":"dd484ee8-aba9-4975-aa92-91a5d20cd139"},{"type":"InstitutionUser","uuid":"3e308d3b-281c-4f8c-b043-52d529540da1","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"TEMPBFJPEN_1999-2009"}]},{"type":"InstitutionUser","uuid":"84519bbe-4dca-458e-a2d6-10c115ec9b61","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"EAL00000039573"}]},{"type":"InstitutionUser","uuid":"160fbf7f-f31b-43ae-bb20-bc1e9c9d98b9","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"P#DEAL"}]},{"type":"RegionUser","uuid":"20d013f5-e22b-4df0-ba93-d6d925db9e32"},{"type":"BasicGroup","uuid":"bd2fcf7d-fa23-4396-9340-9ee81267838e"},{"type":"BasicGroup","uuid":"84aa8781-b32a-4f06-979c-30f3ab78ad73"},{"type":"InstitutionUser","uuid":"b2f03c7d-def5-4d65-8e7e-4c3ca2f4b975","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"TEMPBFNCP_1986-1998"}]},{"type":"BasicGroup","uuid":"e623deab-c83b-41e3-84a2-d9f1d46c5f17"},{"type":"SmartGroupUser","uuid":"a86d27d2-6bcd-4b94-bca5-fe16f4882855"},{"type":"ReferrerUser","uuid":"5a2c1d70-1255-4a45-95f3-a3aa3a2771fb"},{"type":"SmartGroupUser","uuid":"cdce41c2-a8de-4a64-a4d9-a85caaaa2314"},{"type":"InstitutionUser","uuid":"c1360419-3aa0-48db-bf5e-9e13ab5176d0","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"TEMPBFNCP_1999-2017"}]},{"type":"BasicGroup","uuid":"c62f6a8d-8b0e-4a8c-ace7-645ca96979b6"},{"type":"BasicGroup","uuid":"197fe835-5b5f-4f4e-b8e9-a74d68491a84"},{"type":"SmartGroupUser","uuid":"1a6297fb-6679-4882-a4c2-fdd124624edf"},{"type":"InstitutionUser","uuid":"9b729461-619c-4979-aea1-815c4c3d701a","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"TEMPBFNCP_1999-2009"}]},{"type":"SmartGroupUser","uuid":"c261fc17-ddd0-40b4-b3cf-c86aa69533ae"},{"type":"InstitutionUser","uuid":"cc0258d4-b10e-4e8f-966b-fe551d394214","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"BLMSBACKFILE"}]},{"type":"InstitutionUser","uuid":"a8ea2a6a-a974-4fb8-b407-7e50c6c792af","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"COCHRANEGERMANY"}]},{"type":"InstitutionUser","uuid":"d36186a0-6994-40a6-a666-e3c65032fa8b","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"TEMPBFJPEN_1999-2017"}]},{"type":"SmartGroupUser","uuid":"e2cf122c-6ff9-4167-9a85-09549154cb43"},{"type":"InstitutionUser","uuid":"67088c1f-befc-41a8-83ab-0c726c5c5b7e","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"EAL0000018963"}]},{"type":"InstitutionUser","uuid":"7c93c8fe-e69a-469b-9842-a2f398a09ead","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"P#DFG"}]},{"type":"SmartGroupUser","uuid":"261f34be-39f9-4f9e-8feb-500f73213904"},{"type":"InstitutionUser","uuid":"2553a459-b7e6-4d7a-8940-1c304cb881c2","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"JLMSBACKFILE"}]},{"type":"SmartGroupUser","uuid":"055a2bdd-861f-4fa7-bd49-9773db7e0e3e"},{"type":"SmartGroupUser","uuid":"b2dbfe27-ecae-4bb6-bb0d-d75e5caa3762"},{"type":"InstitutionUser","uuid":"99bd6d39-79db-401d-8347-f08852783baa","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"P#HEBISTCL"}]},{"type":"InstitutionUser","uuid":"0d015646-c4b1-4570-82a2-3de479c144ed","customerRecords":[{"customerDomain":"ALM-CU","customerNumber":"EAL00000018963"}]}],"publication":{"item":{"title":"Transforming malicious code to ROP gadgets for antivirus evasion","doi":"10.1049/iet-ifs.2018.5386","access":"free","earliestDate":"2019-11-01","formats":["Abstract","Cited by","First page image","Full text","PDF","References"],"topics":[{"taxonomyUri":"embo-article-types","topicLabel":"Article","topicUri":"article"},{"taxonomyUri":"global-subject-codes","topicLabel":"COMPUTER SCIENCE","topicUri":"cs"},{"taxonomyUri":"global-subject-codes","topicLabel":"General \u0026 Introductory Computer Science","topicUri":"cs00"}]},"group":{"doi":"10.1049/ise2.v13.6","access":"free","volume":"13","issue":"6","coverDate":"2019-11-01","topics":[{"taxonomyUri":"global-subject-codes","topicLabel":"COMPUTER SCIENCE","topicUri":"cs"},{"taxonomyUri":"global-subject-codes","topicLabel":"General \u0026 Introductory Computer Science","topicUri":"cs00"}]},"series":{"title":"IET Information Security","doi":"10.1049/(ISSN)1751-8717","access":"free","code":"17518717","issn":"1751-8709","eissn":"1751-8717","topics":[{"taxonomyUri":"gpt-sitename","topicLabel":"wly.compu.sci_000038","topicUri":"wly.compu.sci_000038"},{"taxonomyUri":"gpt-zonename","topicLabel":"iet-information-security_ISE2","topicUri":"iet-information-security_ise2"},{"taxonomyUri":"global-subject-codes","topicLabel":"COMPUTER SCIENCE","topicUri":"cs"},{"taxonomyUri":"global-subject-codes","topicLabel":"General \u0026 Introductory Computer Science","topicUri":"cs00"}]}},"tokens":{"tokenUsed":false}}};
    
    var digitalData = window.digitalData ? digitalData : {};
    digitalData.event = digitalData.event || [];
</script>
<script src="./Transforming malicious code to ROP gadgetsfor antivirus evasion_files/satelliteLib-c1ac050bbdc647f13a62578e71f0d817f8a6cbb5.js"></script>
        
        





        
        






    <link rel="preload" href="./Transforming malicious code to ROP gadgetsfor antivirus evasion_files/osano.js" as="script">
    <script src="./Transforming malicious code to ROP gadgetsfor antivirus evasion_files/osano.js"></script>

    <script src="./Transforming malicious code to ROP gadgetsfor antivirus evasion_files/api.js" async=""></script></head>
    
    <body class="keyboard" style="display: none">
        
            <h1 aria-live="assertive" role="status" id="statusHeading" class="visually-hidden">Publication loaded</h1>
        
        









<noscript>
    <div id="alert_box" class="popup_container full noScript">
        <div class="popup_content">
            <div class="flex-container">
                <div class="text">
                    <span class="popupIcon icon material-icons" data-type="">error_outline</span>
                    <div>
                        <h1 class="popupTitle">JavaScript disabled</h1>
                        <p class="popupDescription">You have to enable JavaScript in your browser's settings in order to use the eReader.</p>
                        
                            <p class="popupDescription">Or try downloading the content offline</p>
                            <a href="/doi/pdfdirect/10.1049/iet-ifs.2018.5386?download=true" target="_blank" class="btn--bordered__light">DOWNLOAD</a>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <style>
        #app-container, .navbar {display: none !important;}
    </style>
</noscript>
        <nav id="app-navbar" class="navbar isFixed" role="banner" aria-label="Toolbar"><div class="btn-group navbar-left">
        <div class="grouped hide-lg lpanel_toggle_wrapper">
    <button id="leftPanelmobile" class="l-panel--trigger btn" title="Publication Info [i]" type="button" tabindex="0" accesskey="i">
        <span class="icon material-icons" aria-hidden="true">menu</span>
        <span class="icon material-icons expanded" aria-hidden="true">close</span>
    </button>
</div>
<div id="reader-left-panel" class="tabs" aria-label="" role="navigation"><div class="lpbutton show-lg">
    <div class="l-panel--button-container">
        <button class="l-panel--trigger btn--rounded btn" id="leftPanelbtn" title="Publication Info [i]" aria-label="Toggle left panel" data-tooltip-position="right" type="button" tabindex="0" accesskey="i">
            <span class="icon reader-double-arrow flip-horizontal" aria-hidden="true"></span>
        </button>

        <button class="btn--rounded btn--cta__light btn" id="infoDesktop" title="Details" aria-label="Toggle Details panel" data-tooltip-position="right" data-trigger="#info" type="button" tabindex="0" accesskey="">
            <span class="icon material-icons" aria-hidden="true">info
                
                
            </span>
        </button>
        <button class="btn--rounded btn--cta__light btn" id="chaptersDesktop" title="Outline" aria-label="Toggle Outline panel" data-tooltip-position="right" data-trigger="#chapters" type="button" tabindex="0" accesskey="">
            <span class="icon material-icons" aria-hidden="true">list
                
                
            </span>
        </button>
        <button class="btn--rounded btn--cta__light btn" id="filesDesktop" title="Materials" aria-label="Toggle Materials panel" data-tooltip-position="right" data-trigger="#files" type="button" tabindex="0" accesskey="">
            <span class="icon reader-material-folder" aria-hidden="true">
                
                
            </span>
        </button>
        <button class="btn--rounded btn--cta__light btn" id="linksDesktop" title="Links" aria-label="Toggle Links panel" data-tooltip-position="right" data-trigger="#links" type="button" tabindex="0" accesskey="">
            <span class="icon material-icons rotate-135" aria-hidden="true">link
                
                
            </span>
        </button>
    </div>
</div>

<div class="overflow-container">
    <div class="extra_actions show-sm-flex">
        <button class="l-panel--trigger btn--action__text btn" type="button" tabindex="0" accesskey="">
            <span class="tab-text">CLOSE</span>
        </button>
    </div>

    <div class="l-panel-tabs-container">
        <div class="pubDetails hide-lg">
            <h4 class="pub_type">article</h4>
            <h3 class="pub_title js__book-title" title="Transforming malicious code to ROP gadgets for antivirus evasion">Transforming malicious code to ROP gadgets for antivirus evasion</h3>
        </div>

        <ul class="drawerMenu dark slider" role="menu">
            <li class="list-item d-block" role="menuitem" aria-haspopup="true" aria-expanded="false" aria-disabled="false">
                <button id="info" class="drawerMenu--trigger list-button toggle-submenu btn" type="button" tabindex="0" accesskey="">
                <span class="back-btn btn--action__text">
                    <span class="icon material-icons hidden-desktop" aria-hidden="true">navigate_before</span>
                    BACK
                </span>
                    <span class="icon material-icons" aria-hidden="true">info</span>
                    <span class="tab-text">Details</span>
                </button>

                <div id="info-tab-pane" class="submenu"><div class="paddedPane">
    <div class="stickify show-lg">
        <h3 class="primaryTitle">Details</h3>
    </div>


    <div class="item-info">
        <div class="metadata" lang="en">
   <div class="cover"><img src="./Transforming malicious code to ROP gadgetsfor antivirus evasion_files/ise2.v13.6.cover.gif" alt="Cover Image" class="cover"></div>
   <h6>ARTICLE</h6>
   <h4 class="title">Transforming malicious code to ROP gadgets for antivirus evasion</h4>
   <div class="authors"><span class="author">Christoforos Ntantogian, </span><span class="author">Georgios Poulios, </span><span class="author">Georgios Karopoulos, </span><span class="author">Christos Xenakis</span></div><a href="https://ietresearch.onlinelibrary.wiley.com/action/showCitFormats?doi=10.1049%2Fiet-ifs.2018.5386&amp;mobileUi=0" class="btn btn--secondary citation_btn " target="_blank" accesskey="c" aria-label="export citation">
    <span class="icon material-icons">format_quote</span>
    <span class="text">CITE</span>
</a>

   <div class="publication-details">
      <div class="copyright">© 2020 The Institution of Engineering and Technology</div><a class="" target="_blank" accesskey="c" aria-label="doi" href="https://doi.org/10.1049/iet-ifs.2018.5386">https://doi.org/10.1049/iet-ifs.2018.5386</a><div class="details-section">
         <div class="details-entry"><span class="details-label">Published in</span><span class="details-value">IET Information Security</span></div>
         <div class="details-entry"><span class="details-label" style="">Publisher</span><span class="details-value">The Institution of Engineering and Technology</span></div>
         <div class="issn">
            <div class="details-entry"><span class="details-label">ISSN</span><span class="details-value">1751-8709</span></div>
         </div>
         <div class="details-entry"><span class="details-label">eISSN</span><span class="details-value">1751-8717</span></div>
         <p class="received-date">
            </p><div class="details-entry"><span class="details-label">Received</span><span class="details-value">26 July 2018</span></div>
         <p></p>
         <div class="details-entry"><span class="details-label">Accepted</span><span class="details-value">13 March 2019</span></div>
         <div class="details-entry"><span class="details-label">Published</span><span class="details-value">1 November 2019</span></div>
         <div class="details-entry"><span class="details-label">Volume</span><span class="details-value">13</span></div>
         <div class="details-entry"><span class="details-label">Issue</span><span class="details-value">6</span></div>
         <div class="details-entry"><span class="details-label">Pages</span><span class="details-value">570
                    -
                    578</span></div>
      </div>
   </div>
   <div class="abstract">
      <div>
         <p>This study advances research in offensive technology by proposing return oriented programming (ROP) as a means to achieve code obfuscation. The key inspiration is that ROP's unique structure poses various challenges to malware analysis compared to traditional shellcode inspection and detection. The proposed ROP-based attack vector provides two unique features: (i) the ability to automatically analyse and generate equivalent ROP chains for a given code, and (ii) the ability to reuse legitimate code found in an executable in the form of ROP gadgets. To this end, a software tool named ROPInjector was developed which, given any piece of shellcode and any legitimate executable file, it transforms the shellcode to its ROP equivalent re-using the available code in the executable and finally patches the ROP chain infecting the executable. After trying various combinations of evasion techniques, the results show that ROPInjector can evade nearly and completely all antivirus software employed in the online VirusTotal service, making ROP an effective ingredient for code obfuscation. This attack vector poses a serious threat which malicious actors can take advantage to perform cyber-attack campaigns.</p>
      </div>
   </div>
</div>
        
    </div>
</div></div>
            </li>

            <li class="list-item d-block" role="menuitem" aria-haspopup="true" aria-expanded="false" aria-disabled="false">
                <button id="chapters" class="drawerMenu--trigger list-button toggle-submenu btn" type="button" tabindex="0" accesskey="">
                    <span class="back-btn btn--action__text">
                        <span class="icon material-icons hidden-desktop" aria-hidden="true">navigate_before</span>
                        BACK
                    </span>
                    <span class="icon material-icons" aria-hidden="true">list</span>
                    <span class="tab-text">Outline</span>
                </button>

                <div id="reader-toc-body" class="submenu"><div class="paddedPane error-pane">
        <h3 class="primaryTitle show-lg">OUTLINE</h3>
    <div class="panel-error">
        <span class="error-icon icon material-icons" data-type="content">sentiment_very_dissatisfied</span>
        <div class="error-text">This publication does not have an outline.</div>
    </div>
</div>
</div>
            </li>

            <li class="list-item show-lg" role="menuitem" aria-haspopup="true" aria-expanded="false" aria-disabled="false">
                <button id="files" class="drawerMenu--trigger list-button toggle-submenu btn" type="button" tabindex="0" accesskey="">
                <span class="back-btn btn--action__text">
                    <span class="icon material-icons hidden-desktop" aria-hidden="true">navigate_before</span>
                    BACK
                </span>
                    <span class="icon material-icons" aria-hidden="true">perm_media</span>
                    <span class="tab-text">Materials</span>
                </button>
                <div id="files-tab-pane" class="submenu"><div class="paddedPane scrollToTop">
    <div class="stickify">
        <h3 class="primaryTitle">Materials</h3>
        <ul class="tab-nav active" role="tablist">
            <!-- if changes are made in these files, update left-panel-mobile.html -->
            <li role="tab">
                <a class="figures active" href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#figures-tab-pane" role="tab" aria-controls="figures-tab-pane" aria-disabled="false" aria-selected="true" tabindex="0">
                    <span class="tab-text">FIGURES</span>
                    <span class="icon material-icons pull-right hidden-desktop" aria-hidden="true" aria-labelledby="">navigate_next</span>
                </a>
            </li>
            <li role="tab">
                <a class="supplementary" href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#supplementary-tab-pane" aria-selected="false" role="tab" aria-controls="supplementary-tab-pane" aria-disabled="false" tabindex="0">
                    <span class="tab-text">SUPPLEMENTS</span>
                    <span class="icon material-icons pull-right hidden-desktop" aria-hidden="true" aria-labelledby="">navigate_next</span>
                </a>
            </li>
        </ul>
    </div>

    <div class="tab-content">
        <div class="panels" data-vport="1024" data-panel-desktop="figures">
            <div id="figures-tab-pane" class="tab-pane active" role="tabpanel" aria-label="" aria-hidden="false" tabindex="0"><div>
    <figure class="article__tabFigure openInViewer material-fig not-streamed " data-type="figure" data-streamed="" data-graphical-abstract-image="false" data-id="ise2bf00358-fig-0001" data-link="">
    <p class="figure__title">



    </p>

    <div class="figure__media">
        <button aria-label="Open  in viewer" data-tooltip-position="bottom" class="figure__image-btn">
            <img id="ise2bf00358-fig-0001" class="figure__image" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0nMzkzJyBoZWlnaHQ9JzI4MCcgdmlld0JveD0nMCAwIDM5MyAyODAnIGZpbGw9J25vbmUnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zyc+PHBhdGggZmlsbC1ydWxlPSdldmVub2RkJyBjbGlwLXJ1bGU9J2V2ZW5vZGQnIGQ9J00zOTEuNzUgMEgwVjI4MEgzOTEuNzVWMFpNMjQ3LjUxNCA3NEMyNTUuNjE4IDc0IDI2Mi4xODEgODAuNTYzNSAyNjIuMTgxIDg4LjY2NjVWMTkxLjMzM0MyNjIuMTgxIDE5OS40MzcgMjU1LjYxOCAyMDYgMjQ3LjUxNCAyMDZIMTQ0Ljg0OEMxMzYuNzQ0IDIwNiAxMzAuMTgxIDE5OS40MzcgMTMwLjE4MSAxOTEuMzMzVjg4LjY2NjVDMTMwLjE4MSA4MC41NjM1IDEzNi43NDQgNzQgMTQ0Ljg0OCA3NEgyNDcuNTE0Wk0xODguODQ4IDE3My4wMzdMMTcwLjUxNCAxNTFMMTQ0Ljg0OCAxODRIMjQ3LjUxNEwyMTQuNTE0IDE0MEwxODguODQ4IDE3My4wMzdaJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgwLjc1KScgZmlsbD0nIzQxNDE0Qyc+PC9wYXRoPjwvc3ZnPg==" data-src="/cms/asset/b1b675a1-1a21-403d-a4dc-20d2fbc100cf/ise2bf00358-fig-0001-m.png" data-lg-src="/cms/asset/2705387a-5fe6-43fe-bf5a-5d7a1a1a4b10/ise2bf00358-fig-0001-m.jpg" data-type="image" alt="Fig. 1" data-remove-download="false">
        </button>



    </div>

    <div class="figure__caption hasDescription">
        <div class="truncatable">
            <figcaption>
                <span class="title"><span class="label"><alt>Fig. 1</alt></span><p class="hasText">ROPInjector high‐level functionality</p></span>
            </figcaption>


            <div class="desc">Fig.</div>

            <div class="figure__details">


            </div>
        </div>
        <div class="figure__actions">
                <a class="btn btn--light media__download" href="https://ietresearch.onlinelibrary.wiley.com/cms/asset/2705387a-5fe6-43fe-bf5a-5d7a1a1a4b10/ise2bf00358-fig-0001-m.jpg" download="" target="_blank" aria-label="Download ">
                    <span class="icon material-icons">get_app</span>
                </a>

        </div>
    </div>
</figure>
<figure class="article__tabFigure openInViewer material-fig not-streamed " data-type="figure" data-streamed="" data-graphical-abstract-image="false" data-id="ise2bf00358-fig-0002" data-link="">
    <p class="figure__title">



    </p>

    <div class="figure__media">
        <button aria-label="Open  in viewer" data-tooltip-position="bottom" class="figure__image-btn">
            <img id="ise2bf00358-fig-0002" class="figure__image" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0nMzkzJyBoZWlnaHQ9JzI4MCcgdmlld0JveD0nMCAwIDM5MyAyODAnIGZpbGw9J25vbmUnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zyc+PHBhdGggZmlsbC1ydWxlPSdldmVub2RkJyBjbGlwLXJ1bGU9J2V2ZW5vZGQnIGQ9J00zOTEuNzUgMEgwVjI4MEgzOTEuNzVWMFpNMjQ3LjUxNCA3NEMyNTUuNjE4IDc0IDI2Mi4xODEgODAuNTYzNSAyNjIuMTgxIDg4LjY2NjVWMTkxLjMzM0MyNjIuMTgxIDE5OS40MzcgMjU1LjYxOCAyMDYgMjQ3LjUxNCAyMDZIMTQ0Ljg0OEMxMzYuNzQ0IDIwNiAxMzAuMTgxIDE5OS40MzcgMTMwLjE4MSAxOTEuMzMzVjg4LjY2NjVDMTMwLjE4MSA4MC41NjM1IDEzNi43NDQgNzQgMTQ0Ljg0OCA3NEgyNDcuNTE0Wk0xODguODQ4IDE3My4wMzdMMTcwLjUxNCAxNTFMMTQ0Ljg0OCAxODRIMjQ3LjUxNEwyMTQuNTE0IDE0MEwxODguODQ4IDE3My4wMzdaJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgwLjc1KScgZmlsbD0nIzQxNDE0Qyc+PC9wYXRoPjwvc3ZnPg==" data-src="/cms/asset/54e7ca29-472e-4f0b-af42-8a770cdbefc0/ise2bf00358-fig-0002-m.png" data-lg-src="/cms/asset/aadec5fe-4e38-49b7-8b60-b600d880ed13/ise2bf00358-fig-0002-m.jpg" data-type="image" alt="Fig. 2" data-remove-download="false">
        </button>



    </div>

    <div class="figure__caption hasDescription">
        <div class="truncatable">
            <figcaption>
                <span class="title"><span class="label"><alt>Fig. 2</alt></span><p class="hasText">Injection of gadget (right) in 0xCC cave preceded by standard function epilogue (left)</p></span>
            </figcaption>


            <div class="desc">Fig.</div>

            <div class="figure__details">


            </div>
        </div>
        <div class="figure__actions">
                <a class="btn btn--light media__download" href="https://ietresearch.onlinelibrary.wiley.com/cms/asset/aadec5fe-4e38-49b7-8b60-b600d880ed13/ise2bf00358-fig-0002-m.jpg" download="" target="_blank" aria-label="Download ">
                    <span class="icon material-icons">get_app</span>
                </a>

        </div>
    </div>
</figure>
<figure class="article__tabFigure openInViewer material-fig not-streamed " data-type="figure" data-streamed="" data-graphical-abstract-image="false" data-id="ise2bf00358-fig-0003" data-link="">
    <p class="figure__title">



    </p>

    <div class="figure__media">
        <button aria-label="Open  in viewer" data-tooltip-position="bottom" class="figure__image-btn">
            <img id="ise2bf00358-fig-0003" class="figure__image" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0nMzkzJyBoZWlnaHQ9JzI4MCcgdmlld0JveD0nMCAwIDM5MyAyODAnIGZpbGw9J25vbmUnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zyc+PHBhdGggZmlsbC1ydWxlPSdldmVub2RkJyBjbGlwLXJ1bGU9J2V2ZW5vZGQnIGQ9J00zOTEuNzUgMEgwVjI4MEgzOTEuNzVWMFpNMjQ3LjUxNCA3NEMyNTUuNjE4IDc0IDI2Mi4xODEgODAuNTYzNSAyNjIuMTgxIDg4LjY2NjVWMTkxLjMzM0MyNjIuMTgxIDE5OS40MzcgMjU1LjYxOCAyMDYgMjQ3LjUxNCAyMDZIMTQ0Ljg0OEMxMzYuNzQ0IDIwNiAxMzAuMTgxIDE5OS40MzcgMTMwLjE4MSAxOTEuMzMzVjg4LjY2NjVDMTMwLjE4MSA4MC41NjM1IDEzNi43NDQgNzQgMTQ0Ljg0OCA3NEgyNDcuNTE0Wk0xODguODQ4IDE3My4wMzdMMTcwLjUxNCAxNTFMMTQ0Ljg0OCAxODRIMjQ3LjUxNEwyMTQuNTE0IDE0MEwxODguODQ4IDE3My4wMzdaJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgwLjc1KScgZmlsbD0nIzQxNDE0Qyc+PC9wYXRoPjwvc3ZnPg==" data-src="/cms/asset/f37ec192-823d-4f3a-9af2-b2a443a3b312/ise2bf00358-fig-0003-m.png" data-lg-src="/cms/asset/177f3e43-6e94-4f3b-b408-646f7a9898c1/ise2bf00358-fig-0003-m.jpg" data-type="image" alt="Fig. 3" data-remove-download="false">
        </button>



    </div>

    <div class="figure__caption hasDescription">
        <div class="truncatable">
            <figcaption>
                <span class="title"><span class="label"><alt>Fig. 3</alt></span><p class="hasText">Pseudo‐function ending used during gadget injection</p></span>
            </figcaption>


            <div class="desc">Fig.</div>

            <div class="figure__details">


            </div>
        </div>
        <div class="figure__actions">
                <a class="btn btn--light media__download" href="https://ietresearch.onlinelibrary.wiley.com/cms/asset/177f3e43-6e94-4f3b-b408-646f7a9898c1/ise2bf00358-fig-0003-m.jpg" download="" target="_blank" aria-label="Download ">
                    <span class="icon material-icons">get_app</span>
                </a>

        </div>
    </div>
</figure>
<figure class="article__tabFigure openInViewer material-fig not-streamed " data-type="figure" data-streamed="" data-graphical-abstract-image="false" data-id="ise2bf00358-fig-0004" data-link="">
    <p class="figure__title">



    </p>

    <div class="figure__media">
        <button aria-label="Open  in viewer" data-tooltip-position="bottom" class="figure__image-btn">
            <img id="ise2bf00358-fig-0004" class="figure__image" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0nMzkzJyBoZWlnaHQ9JzI4MCcgdmlld0JveD0nMCAwIDM5MyAyODAnIGZpbGw9J25vbmUnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zyc+PHBhdGggZmlsbC1ydWxlPSdldmVub2RkJyBjbGlwLXJ1bGU9J2V2ZW5vZGQnIGQ9J00zOTEuNzUgMEgwVjI4MEgzOTEuNzVWMFpNMjQ3LjUxNCA3NEMyNTUuNjE4IDc0IDI2Mi4xODEgODAuNTYzNSAyNjIuMTgxIDg4LjY2NjVWMTkxLjMzM0MyNjIuMTgxIDE5OS40MzcgMjU1LjYxOCAyMDYgMjQ3LjUxNCAyMDZIMTQ0Ljg0OEMxMzYuNzQ0IDIwNiAxMzAuMTgxIDE5OS40MzcgMTMwLjE4MSAxOTEuMzMzVjg4LjY2NjVDMTMwLjE4MSA4MC41NjM1IDEzNi43NDQgNzQgMTQ0Ljg0OCA3NEgyNDcuNTE0Wk0xODguODQ4IDE3My4wMzdMMTcwLjUxNCAxNTFMMTQ0Ljg0OCAxODRIMjQ3LjUxNEwyMTQuNTE0IDE0MEwxODguODQ4IDE3My4wMzdaJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgwLjc1KScgZmlsbD0nIzQxNDE0Qyc+PC9wYXRoPjwvc3ZnPg==" data-src="/cms/asset/33bc41b3-8692-42e8-a15c-c73ca58889d3/ise2bf00358-fig-0004-m.png" data-lg-src="/cms/asset/95fb6770-a541-4375-871f-48d6f92d4a30/ise2bf00358-fig-0004-m.jpg" data-type="image" alt="Fig. 4" data-remove-download="false">
        </button>



    </div>

    <div class="figure__caption hasDescription">
        <div class="truncatable">
            <figcaption>
                <span class="title"><span class="label"><alt>Fig. 4</alt></span><p class="hasText">ROP compilation algorithm</p></span>
            </figcaption>


            <div class="desc">Fig.</div>

            <div class="figure__details">


            </div>
        </div>
        <div class="figure__actions">
                <a class="btn btn--light media__download" href="https://ietresearch.onlinelibrary.wiley.com/cms/asset/95fb6770-a541-4375-871f-48d6f92d4a30/ise2bf00358-fig-0004-m.jpg" download="" target="_blank" aria-label="Download ">
                    <span class="icon material-icons">get_app</span>
                </a>

        </div>
    </div>
</figure>
<figure class="article__tabFigure openInViewer material-fig not-streamed " data-type="figure" data-streamed="" data-graphical-abstract-image="false" data-id="ise2bf00358-fig-0005" data-link="">
    <p class="figure__title">



    </p>

    <div class="figure__media">
        <button aria-label="Open  in viewer" data-tooltip-position="bottom" class="figure__image-btn">
            <img id="ise2bf00358-fig-0005" class="figure__image" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0nMzkzJyBoZWlnaHQ9JzI4MCcgdmlld0JveD0nMCAwIDM5MyAyODAnIGZpbGw9J25vbmUnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zyc+PHBhdGggZmlsbC1ydWxlPSdldmVub2RkJyBjbGlwLXJ1bGU9J2V2ZW5vZGQnIGQ9J00zOTEuNzUgMEgwVjI4MEgzOTEuNzVWMFpNMjQ3LjUxNCA3NEMyNTUuNjE4IDc0IDI2Mi4xODEgODAuNTYzNSAyNjIuMTgxIDg4LjY2NjVWMTkxLjMzM0MyNjIuMTgxIDE5OS40MzcgMjU1LjYxOCAyMDYgMjQ3LjUxNCAyMDZIMTQ0Ljg0OEMxMzYuNzQ0IDIwNiAxMzAuMTgxIDE5OS40MzcgMTMwLjE4MSAxOTEuMzMzVjg4LjY2NjVDMTMwLjE4MSA4MC41NjM1IDEzNi43NDQgNzQgMTQ0Ljg0OCA3NEgyNDcuNTE0Wk0xODguODQ4IDE3My4wMzdMMTcwLjUxNCAxNTFMMTQ0Ljg0OCAxODRIMjQ3LjUxNEwyMTQuNTE0IDE0MEwxODguODQ4IDE3My4wMzdaJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgwLjc1KScgZmlsbD0nIzQxNDE0Qyc+PC9wYXRoPjwvc3ZnPg==" data-src="/cms/asset/8680ff31-af48-4ad8-a729-66c6ed4e0cc1/ise2bf00358-fig-0005-m.png" data-lg-src="/cms/asset/0df63fbb-7cb0-4e13-a35a-19b97082c3f2/ise2bf00358-fig-0005-m.jpg" data-type="image" alt="Fig. 5" data-remove-download="false">
        </button>



    </div>

    <div class="figure__caption hasDescription">
        <div class="truncatable">
            <figcaption>
                <span class="title"><span class="label"><alt>Fig. 5</alt></span><p class="hasText">Gadget injection algorithm</p></span>
            </figcaption>


            <div class="desc">Fig.</div>

            <div class="figure__details">


            </div>
        </div>
        <div class="figure__actions">
                <a class="btn btn--light media__download" href="https://ietresearch.onlinelibrary.wiley.com/cms/asset/0df63fbb-7cb0-4e13-a35a-19b97082c3f2/ise2bf00358-fig-0005-m.jpg" download="" target="_blank" aria-label="Download ">
                    <span class="icon material-icons">get_app</span>
                </a>

        </div>
    </div>
</figure>
<figure class="article__tabFigure openInViewer material-fig not-streamed " data-type="figure" data-streamed="" data-graphical-abstract-image="false" data-id="ise2bf00358-fig-0006" data-link="">
    <p class="figure__title">



    </p>

    <div class="figure__media">
        <button aria-label="Open  in viewer" data-tooltip-position="bottom" class="figure__image-btn">
            <img id="ise2bf00358-fig-0006" class="figure__image" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0nMzkzJyBoZWlnaHQ9JzI4MCcgdmlld0JveD0nMCAwIDM5MyAyODAnIGZpbGw9J25vbmUnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zyc+PHBhdGggZmlsbC1ydWxlPSdldmVub2RkJyBjbGlwLXJ1bGU9J2V2ZW5vZGQnIGQ9J00zOTEuNzUgMEgwVjI4MEgzOTEuNzVWMFpNMjQ3LjUxNCA3NEMyNTUuNjE4IDc0IDI2Mi4xODEgODAuNTYzNSAyNjIuMTgxIDg4LjY2NjVWMTkxLjMzM0MyNjIuMTgxIDE5OS40MzcgMjU1LjYxOCAyMDYgMjQ3LjUxNCAyMDZIMTQ0Ljg0OEMxMzYuNzQ0IDIwNiAxMzAuMTgxIDE5OS40MzcgMTMwLjE4MSAxOTEuMzMzVjg4LjY2NjVDMTMwLjE4MSA4MC41NjM1IDEzNi43NDQgNzQgMTQ0Ljg0OCA3NEgyNDcuNTE0Wk0xODguODQ4IDE3My4wMzdMMTcwLjUxNCAxNTFMMTQ0Ljg0OCAxODRIMjQ3LjUxNEwyMTQuNTE0IDE0MEwxODguODQ4IDE3My4wMzdaJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgwLjc1KScgZmlsbD0nIzQxNDE0Qyc+PC9wYXRoPjwvc3ZnPg==" data-src="/cms/asset/a21b574f-55b1-4eee-b099-f298eda29509/ise2bf00358-fig-0006-m.png" data-lg-src="/cms/asset/b5adbdba-93b4-4354-9892-c1cbac3c7e6d/ise2bf00358-fig-0006-m.jpg" data-type="image" alt="Fig. 6" data-remove-download="false">
        </button>



    </div>

    <div class="figure__caption hasDescription">
        <div class="truncatable">
            <figcaption>
                <span class="title"><span class="label"><alt>Fig. 6</alt></span><p class="hasText">Evasion ratio of ROPInjector for the meterpreter reverse tcp per file</p></span>
            </figcaption>


            <div class="desc">Fig.</div>

            <div class="figure__details">


            </div>
        </div>
        <div class="figure__actions">
                <a class="btn btn--light media__download" href="https://ietresearch.onlinelibrary.wiley.com/cms/asset/b5adbdba-93b4-4354-9892-c1cbac3c7e6d/ise2bf00358-fig-0006-m.jpg" download="" target="_blank" aria-label="Download ">
                    <span class="icon material-icons">get_app</span>
                </a>

        </div>
    </div>
</figure>
<figure class="article__tabFigure openInViewer material-fig not-streamed " data-type="figure" data-streamed="" data-graphical-abstract-image="false" data-id="ise2bf00358-fig-0007" data-link="">
    <p class="figure__title">



    </p>

    <div class="figure__media">
        <button aria-label="Open  in viewer" data-tooltip-position="bottom" class="figure__image-btn">
            <img id="ise2bf00358-fig-0007" class="figure__image" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0nMzkzJyBoZWlnaHQ9JzI4MCcgdmlld0JveD0nMCAwIDM5MyAyODAnIGZpbGw9J25vbmUnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zyc+PHBhdGggZmlsbC1ydWxlPSdldmVub2RkJyBjbGlwLXJ1bGU9J2V2ZW5vZGQnIGQ9J00zOTEuNzUgMEgwVjI4MEgzOTEuNzVWMFpNMjQ3LjUxNCA3NEMyNTUuNjE4IDc0IDI2Mi4xODEgODAuNTYzNSAyNjIuMTgxIDg4LjY2NjVWMTkxLjMzM0MyNjIuMTgxIDE5OS40MzcgMjU1LjYxOCAyMDYgMjQ3LjUxNCAyMDZIMTQ0Ljg0OEMxMzYuNzQ0IDIwNiAxMzAuMTgxIDE5OS40MzcgMTMwLjE4MSAxOTEuMzMzVjg4LjY2NjVDMTMwLjE4MSA4MC41NjM1IDEzNi43NDQgNzQgMTQ0Ljg0OCA3NEgyNDcuNTE0Wk0xODguODQ4IDE3My4wMzdMMTcwLjUxNCAxNTFMMTQ0Ljg0OCAxODRIMjQ3LjUxNEwyMTQuNTE0IDE0MEwxODguODQ4IDE3My4wMzdaJyB0cmFuc2Zvcm09J3RyYW5zbGF0ZSgwLjc1KScgZmlsbD0nIzQxNDE0Qyc+PC9wYXRoPjwvc3ZnPg==" data-src="/cms/asset/761309ea-579a-451f-bbc1-57f6a53fa350/ise2bf00358-fig-0007-m.png" data-lg-src="/cms/asset/112db542-1837-40f9-b15f-a672cad08850/ise2bf00358-fig-0007-m.jpg" data-type="image" alt="Fig. 7" data-remove-download="false">
        </button>



    </div>

    <div class="figure__caption hasDescription">
        <div class="truncatable">
            <figcaption>
                <span class="title"><span class="label"><alt>Fig. 7</alt></span><p class="hasText">Evasion ratio of ROPInjector for the reverse meterpreter payload per method (ROP‐exit scenario)</p></span>
            </figcaption>


            <div class="desc">Fig.</div>

            <div class="figure__details">


            </div>
        </div>
        <div class="figure__actions">
                <a class="btn btn--light media__download" href="https://ietresearch.onlinelibrary.wiley.com/cms/asset/112db542-1837-40f9-b15f-a672cad08850/ise2bf00358-fig-0007-m.jpg" download="" target="_blank" aria-label="Download ">
                    <span class="icon material-icons">get_app</span>
                </a>

        </div>
    </div>
</figure>


</div></div>
        </div>
        <div class="panels" data-vport="1024" data-panel-desktop="supplements">
            <div id="supplementary-tab-pane" class="tab-pane has-error" role="tabpanel" aria-hidden="true" aria-label="" tabindex="0"><div class="paddedPane error-pane">
    <div class="panel-error">
        <span class="error-icon icon material-icons" data-type="content">image</span>
        <div class="error-text">Supplementary materials are not available for display.</div>
    </div>
</div>
</div>
        </div>
    </div>
</div></div>
            </li>
            <li class="list-item d-block hide-lg" role="menuitem" aria-haspopup="true" aria-expanded="false" aria-disabled="false">
                <button id="figures" class="drawerMenu--trigger list-button toggle-submenu btn" type="button" tabindex="0" accesskey="">
                <span class="back-btn btn--action__text">
                    <span class="icon material-icons hidden-desktop" aria-hidden="true">navigate_before</span>
                    BACK
                </span>
                    <span class="icon material-icons" aria-hidden="true">image</span>
                    <span class="tab-text">Figures</span>
                </button>
                <div class="submenu hide-lg">
                    <div class="paddedPane">
                        <div data-vport="1024" data-panel-mobile="figures"></div>
                    </div>
                </div>
            </li>
            <li class="list-item d-block hide-lg" role="menuitem" aria-haspopup="true" aria-expanded="false" aria-disabled="false">
                <button id="supplementary" class="drawerMenu--trigger list-button toggle-submenu btn" type="button" tabindex="0" accesskey="">
                <span class="back-btn btn--action__text">
                    <span class="icon material-icons hidden-desktop" aria-hidden="true">navigate_before</span>
                    BACK
                </span>
                    <span class="icon material-icons" aria-hidden="true">perm_media</span>
                    <span class="tab-text">Supplements</span>
                </button>
                <div class="submenu hide-lg">
                    <div class="paddedPane">
                        <div data-vport="1024" data-panel-mobile="supplements"></div>
                    </div>
                </div>
            </li>


            <li class="list-item show-lg" role="menuitem" aria-haspopup="true" aria-expanded="false" aria-disabled="false">
                <button id="links" class="drawerMenu--trigger list-button toggle-submenu btn" type="button" tabindex="0" accesskey="">
                <span class="back-btn btn--action__text">
                    <span class="icon material-icons hidden-desktop" aria-hidden="true">navigate_before</span>
                    BACK
                </span>
                    <span class="icon material-icons rotate-135" aria-hidden="true">link</span>
                    <span class="tab-text">Links</span>
                </button>
                <div id="links-tab-pane" class="submenu"><div class="paddedPane">
    <div class="stickify">
        <h3 class="primaryTitle">Links</h3>
        <ul class="tab-nav active" role="tablist">
            <!-- if changes are made in these files, update left-panel-mobile.html -->
            <li role="tab">
                <a class="references" href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#references-tab-pane" role="tab" aria-controls="references-tab-pane" aria-disabled="false" aria-selected="false" tabindex="0">
                    <span class="tab-text">REFERENCES</span>
                    <span class="icon material-icons pull-right hidden-desktop" aria-hidden="true" aria-labelledby="">navigate_next</span>
                </a>
            </li>
            <li role="tab">
                <a class="citations" href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#citations-tab-pane" aria-selected="false" role="tab" aria-controls="citations-tab-pane" aria-disabled="false" tabindex="0">
                    <span class="tab-text">CITED BY</span>
                    <span class="icon material-icons pull-right hidden-desktop" aria-hidden="true" aria-labelledby="">navigate_next</span>
                </a>
            </li>
            <li role="tab">
                <a class="recommended" href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#recommended-tab-pane" aria-selected="false" role="tab" aria-controls="recommended-tab-pane" aria-disabled="false" tabindex="0">
                    <span class="tab-text">RECOMMENDED</span>
                    <span class="icon material-icons pull-right hidden-desktop" aria-hidden="true" aria-labelledby="">navigate_next</span>
                </a>
            </li>
        </ul>
    </div>

    <div class="tab-content has-tabs">
        <div class="panels" data-vport="1024" data-panel-desktop="ref">
            <div id="references-tab-pane" class="tab-pane" role="tabpanel" aria-label="" aria-hidden="true" tabindex="0">
                
            </div>
        </div>
        <div class="panels" data-vport="1024" data-panel-desktop="cit">
            <div id="citations-tab-pane" class="tab-pane" role="tabpanel" aria-hidden="true" aria-label="" tabindex="0"></div>
        </div>
        <div class="panels" data-vport="1024" data-panel-desktop="recommended">
            <div id="recommended-tab-pane" class="tab-pane" role="tabpanel" aria-hidden="true" aria-label="" tabindex="0">
                
            </div>
        </div>
    </div>
</div></div>
            </li>
            <li class="list-item d-block hide-lg" role="menuitem" aria-haspopup="true" aria-expanded="false" aria-disabled="false">
                <button id="references" class="drawerMenu--trigger list-button toggle-submenu btn" type="button" tabindex="0" accesskey="">
                <span class="back-btn btn--action__text">
                    <span class="icon material-icons hidden-desktop" aria-hidden="true">navigate_before</span>
                    BACK
                </span>
                    <span class="icon material-icons rotate-135" aria-hidden="true">link</span>
                    <span class="tab-text">References</span>
                </button>
                <div class="submenu hide-lg">
                    <div class="paddedPane">
                        <div data-vport="1024" data-panel-mobile="ref"></div>
                    </div>
                </div>
            </li>
            <li class="list-item d-block hide-lg" role="menuitem" aria-haspopup="true" aria-expanded="false" aria-disabled="false">
                <button id="citations" class="drawerMenu--trigger list-button toggle-submenu btn" type="button" tabindex="0" accesskey="">
                <span class="back-btn btn--action__text">
                    <span class="icon material-icons hidden-desktop" aria-hidden="true">navigate_before</span>
                    BACK
                </span>
                    <span class="icon material-icons" aria-hidden="true">format_quote</span>
                    <span class="tab-text">Cited by</span>
                </button>
                <div class="submenu hide-lg">
                    <div class="paddedPane">
                        <div data-vport="1024" data-panel-mobile="cit"></div>
                    </div>
                </div>
            </li>
            <li class="list-item d-block hide-lg" role="menuitem" aria-haspopup="true" aria-expanded="false" aria-disabled="false">
                <button id="recommended" class="drawerMenu--trigger list-button toggle-submenu btn" type="button" tabindex="0" accesskey="">
                <span class="back-btn btn--action__text">
                    <span class="icon material-icons hidden-desktop" aria-hidden="true">navigate_before</span>
                    BACK
                </span>
                    <span class="icon material-icons" aria-hidden="true">more_horiz</span>
                    <span class="tab-text">Recommended</span>
                </button>
                <div class="submenu hide-lg">
                    <div class="paddedPane">
                        <div data-vport="1024" data-panel-mobile="recommended"></div>
                    </div>
                </div>
            </li>
        </ul>
    </div>
</div>
</div>

        <div class="grouped hide-sm"><a aria-label="View in website" class="open-in-website js__fullSite btn btn--light" href="https://ietresearch.onlinelibrary.wiley.com/doi/10.1049/iet-ifs.2018.5386" id="" target="_blank" title="" data-tooltip-position="">
    <span class="icon material-icons">open_in_new</span>    <span class="tab-text">View in Publisher's site</span>
</a>
</div>
</div>


<div class="btn-group navbar-center">
        <div class="dropdown-widget paging grouped" data-persist="">
    <button id="" class="dropdown-trigger btn btn--light fxl" title="Select page [P]" aria-label="Select page" data-tooltip-position="" aria-haspopup="true" type="button" tabindex="0" accesskey="p" aria-expanded="false">
        <span class="d-none d-md-inline-block pagination_button_text">Page</span><span class="cpage">1</span><span class="separator">/</span><span class="allpages">9</span><span class="animated_arrow_down"></span>
    </button>
    <div id="" class="dropdown-content dropdown-list medium" aria-label="" aria-labelledby="">
        <div class="dropdown-content-wrapper scrollToTop">
            <ul role="list">
    <li class="list-item">
        <button class="nodeTraverse next list-button btn" type="button" tabindex="0" accesskey="">
            <span class="icon material-icons" aria-hidden="true">skip_next</span>
            <span class="tab-text">Next</span>
        </button>
    </li>
    <li class="list-item">
        <button class="nodeTraverse previous list-button btn" type="button" tabindex="0" accesskey="" disabled="disabled">
            <span class="icon material-icons" aria-hidden="true">skip_previous</span>
            <span class="tab-text">Previous</span>
        </button>
    </li>
    <li class="list-item">
        <button class="js__paging-first list-button btn" type="button" tabindex="0" accesskey="">
            <span class="icon reader-previous" aria-hidden="true"></span>
            <span class="tab-text">Go to start</span>
        </button>
    </li>
    <li class="list-item">
        <button class="js__paging-last list-button btn" type="button" tabindex="0" accesskey="">
            <span class="icon reader-next" aria-hidden="true"></span>
            <span class="tab-text">Go to the end</span>
        </button>
    </li>
    <li class="list-item content-item">
        <div class="page-selector">
                    <span class="list_title">go to page</span>
            <div role="group" aria-label="Go to specified page">
                <input type="number" name="page-select" value="" id="page_num" min="0" max="9" placeholder="Number" aria-label="page number" data-no-tooltip="">
                <button id="gotopage" class="js__paging-select btn--cta__light btn" title="Go to specified page" data-alt-title="Go to specified page" type="button" tabindex="0" accesskey="">
                    <span class="icon reader-double-arrow flip-horizontal" aria-hidden="true"></span>
                </button>
                <div class="errors" aria-label="Go to specified page"></div>
            </div>
        </div>
    </li>
    
</ul>

        </div>
    </div>
</div>

        <div class="dropdown-widget grouped reading_options settings-dialog reading-options-navbar" data-persist="">
    <button id="readingOptionsBtn" class="dropdown-trigger btn btn--light" title="Reading options [r]" aria-label="Select node" data-tooltip-position="" aria-haspopup="true" type="button" tabindex="0" accesskey="r" aria-expanded="false">
        <span class="icon material-icons reflow" aria-hidden="true">format_size</span><span class="icon reader-reading-options fxl" aria-hidden="true"></span>
    </button>
    <div id="" class="dropdown-content dropdown-list slim" aria-label="" aria-labelledby="readingOptionsBtn">
        <div class="dropdown-content-wrapper scrollToTop">
            <div class="options-fields reflow">
    <div class="option-field option-alignment">
        <span class="option-title">Alignment</span>
        <div class="option-items">
            <div class="toggle-btn-group can-unchecked" role="radiogroup" aria-label="Text alignment" tabindex="0">
                <input type="radio" id="align-left" name="justify" value="auto" aria-label="Align left">
                <label for="align-left">
                    <span class="icon material-icons">format_align_left</span>
                </label>
                <input type="radio" id="align-justify" name="justify" value="justify" aria-label="Justify">
                <label for="align-justify">
                    <span class="icon material-icons">format_align_justify</span>
                </label>
            </div>
        </div>
    </div>

    <div class="option-field option-font-size">
        <span class="option-title">Font Size</span>
        <div class="option-items" role="group" aria-label="Font size">
            <button class="btn btn--rounded btn--secondary__light font-btn minus" aria-label="Decrease" type="button" tabindex="0" accesskey="">
                <span class="icon material-icons" aria-hidden="true">remove</span>
            </button>
            <button class="btn btn--rounded btn--secondary__light font-btn plus" aria-label="Increase" type="button" tabindex="0" accesskey="">
                <span class="icon material-icons" aria-hidden="true">add</span>
            </button>
            <input type="hidden" id="font-size-input" value="100">
        </div>
    </div>

    <div class="option-field options-hyphenation">
        <div class="toggle-checkbox">
            <input class="light" type="checkbox" name="hyphenate" id="hyphenate-checkbox">
            <label class="option-title" for="hyphenate-checkbox">Hyphenation</label>
        </div>
    </div>

    <div class="options-return-defaults">
        <button class="btn btn-link" type="button" tabindex="0" accesskey="">
            <i class="material-icons icon" aria-hidden="true">close</i>
            Return to default styles
        </button>
    </div>
</div>
<div class="options-fields">
    <div class="option-field option-reading-flow">
        <span class="option-title">Reading Flow</span>
        <div class="option-items">
            <div class="toggle-btn-group" role="radiogroup" aria-label="Reading flow">
                <input type="radio" id="flow-vertical" name="scrolling" value="continuous" aria-label="Vertical continuous scroll">
                <label for="flow-vertical">
                    <span class="icon material-icons">swap_vert</span>
                </label>
                <input type="radio" id="flow-horizontal" name="scrolling" value="auto" aria-label="Horizontal paginated">
                <label for="flow-horizontal">
                    <span class="icon material-icons">swap_horiz</span>
                </label>
            </div>
        </div>
    </div>

    
</div>

        </div>
    </div>
</div>

</div>


<div class="btn-group navbar-right">
    <div class="left">
        <div class="zoom-wrapper fxl grouped left d-none d-md-flex">

    <button class="zoom-btn width btn--light btn" title="Fit Width [h]" aria-label="fit width " type="button" tabindex="0" accesskey="h">
        <span class="icon material-icons" aria-hidden="true">fullscreen</span>
    </button>
    <button class="zoom-btn height d-none btn--light btn" title="Fit Height [h]" aria-label="fit height" type="button" tabindex="0" accesskey="h">
        <span class="icon material-icons" aria-hidden="true">fullscreen_exit</span>
    </button>

    <input tabindex="0" type="text" value="100%" disabled="" class="d-none">
    <button class="zoom-btn out btn--light btn" title="Zoom Out [z]" aria-label="zoom out" type="button" tabindex="0" accesskey="z">
        <span class="icon material-icons" aria-hidden="true">remove_circle_outline</span>
    </button>
    <button class="btn zoom-btn in btn--light" title="Zoom In [x]" aria-label="zoom in" type="button" tabindex="0" accesskey="x">
        <span class="icon material-icons" aria-hidden="true">add_circle_outline</span>
    </button>
</div>
<div></div>

    </div>
    <div class="grouped center">
        <div class="dropdown-widget search" data-persist="true">
    <button id="" class="dropdown-trigger btn btn--light search-trigger" title="Search [s]" aria-label="Search document" data-tooltip-position="" aria-haspopup="true" type="button" tabindex="0" accesskey="s" aria-expanded="false">
        <span class="icon material-icons" aria-hidden="true">search</span>
    </button>
    <div id="" class="dropdown-content " aria-label="" aria-labelledby="">
        <div class="dropdown-content-wrapper scrollToTop">
            <div class="row">
    <div class="topRow">
        <form method="post" action="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#" role="search">
            <div class="fieldWithButton">
                <input class="search-field" placeholder="Search this document...">
                <button type="submit" class="btn--cta__light small submit">
                    <span class="d-none d-md-inline-block">SEARCH</span>
                    <span class="d-inline-block d-md-none icon material-icons">search</span>
                </button>
            </div>
        </form>
        <button type="button" class="close-search-btn d-inline-flex btn dropdown-trigger" aria-haspopup="true" aria-expanded="false">
            <span class="d-inline-block icon material-icons">close</span>
        </button>
    </div>
    <div class="results"></div>
</div>

        </div>
    </div>
</div>
<div class="d-inline-flex clipboard share-access-navbar"><button id="shareTrigger" class="btn shareAccessUrl btn--light" title="Share access [j]" aria-label="share access" data-tooltip-position="" type="button" tabindex="0" accesskey="j">
    <span class="icon material-icons" aria-hidden="true">group_add</span>
</button>
<div class="d-none"><button class="shareAccessUrlClip btn" type="button" tabindex="0" accesskey="">Copy Access</button></div>
</div><div class="dropdown-widget " data-persist="">
    <button id="settings_button" class="dropdown-trigger btn btn--light rpanel_toggle" title="More [o]" aria-label="view more options" data-tooltip-position="bottom" aria-haspopup="true" type="button" tabindex="0" accesskey="o" aria-expanded="false">
        <span class="icon material-icons" aria-hidden="true">more_horiz</span>
    </button>
    <div id="reader-right-panel" class="dropdown-content dropdown-list wide" aria-label="" aria-labelledby="settings_button">
        <div class="dropdown-content-wrapper scrollToTop">
            <ul class="drawerMenu slider" role="menu">
            <li class="list-item print" role="menuitem" aria-haspopup="true" aria-expanded="false" aria-disabled="false">
    <button id="" class="btn drawerMenu--trigger list-button" title="Print document" aria-label="Print document" data-tooltip-position="" type="button" tabindex="0" accesskey="">
    <span class="icon material-icons" aria-hidden="true">print</span><span class="tab-text">Print document</span>
</button>


</li>

        <li class="separator offlineSeparator" role="menuitem" aria-haspopup="true" aria-expanded="false" aria-disabled="false">Offline reading</li>

<li class="list-item offline_library general" role="menuitem" aria-haspopup="true" aria-expanded="false" aria-disabled="false">
    <div class="offline drawerMenu--trigger list-button trigger" data-disable-offline="true" aria-disabled="false">

        <div class="icons stack-icons">
            <span class="icon idle reader-offline_pin"></span>
            <svg class="adding removing progress-ring" height="24" width="24" viewBox="0 0 24 24">
                <circle class="progress-ring__track" stroke-width="2" fill="transparent" r="10" cx="12" cy="12"></circle>
                <circle class="progress-ring__circle" transform="rotate(-90 12 12)" stroke-dashoffset="90" stroke-dasharray="90" stroke-width="2" fill="transparent" r="10" cx="12" cy="12"></circle>
            </svg>
            <button class="cancel adding btn" type="button" tabindex="0" accesskey="">
                <span class="icon material-icons" aria-hidden="true">stop</span>
            </button>
            <span class="icon material-icons done">offline_pin</span>
        </div>

        <button class="general btn idle" type="button" tabindex="0" accesskey="">
            <span class="tab-text">Save for offline reading</span>
        </button>
        <span class="adding tab-text">Saving for offline reading</span>
        <div class="desc idle adding">
            &nbsp;•&nbsp;
            <span class="file-desc">1.7 MB</span>
        </div>
        <div class="done">
            <span class="tab-text">Saved for offline reading</span>
            <button class="remove btn" type="button" tabindex="0" accesskey="">Remove</button>
        </div>

        <div class="removing">
            <span class="tab-text">Removing from offline documents</span>
        </div>
    </div>
</li>

<li class="list-item offline_documents " role="menuitem" aria-haspopup="true" aria-expanded="false" aria-disabled="false">
    <a href="https://ietresearch.onlinelibrary.wiley.com/reader/library" class="drawerMenu--trigger list-button btn" target="_blank" aria-label="View Offline documents">
        <span class="icon material-icons">library_books</span>
        <span class="tab-text">View Offline documents</span>
    </a>
</li>

        <li class="list-item user_id" role="menuitem" aria-haspopup="true" aria-expanded="false" aria-disabled="false">
    
<a href="https://ietresearch.onlinelibrary.wiley.com/action/showLogin?redirectUri=%2Fdoi%2Fepdf%2F10.1049%2Fiet-ifs.2018.5386" class="btn--action__text-secondary">Login</a>
<span class="btn--action__text-secondary no-hover">/</span>
<a href="https://ietresearch.onlinelibrary.wiley.com/action/registration?redirectUri=%2Fdoi%2Fepdf%2F10.1049%2Fiet-ifs.2018.5386" class="btn--action__text-secondary">Register</a>

</li>


</ul>

        </div>
    </div>
</div>

    </div>
    <div class="grouped right">
        <a aria-label="Download PDF • 1.7 MB" class="navbar-download btn btn--cta_roundedColored" href="https://ietresearch.onlinelibrary.wiley.com/doi/pdfdirect/10.1049/iet-ifs.2018.5386?download=true" id="" target="_blank" title="Download [g]" accesskey="g" data-tooltip-position="bottom" data-single-download="true" data-download-files-key="pdf">
    <span class="icon material-icons">get_app</span>
</a>

    </div>
</div>


<div class="progress">
  <div class="progress-bar" role="progressbar" aria-valuenow="0.005787037037037037" aria-valuemin="1" aria-valuemax="100" style="width: 11.1111%;"></div>
</div>
</nav>
        <div id="app-container" style="display: none">
            
                

                <div id="reading-area" role="main" class="isFixed scroll">
                <div id="outerContainer"><div id="mainContainer"><div id="viewerContainer" tabindex="0"><div id="viewer" class="pdfViewer"><div class="page" data-page-number="1" role="region" style="width: 992px; height: 1403px;" data-loaded="true"><div class="canvasWrapper" style="width: 992px; height: 1403px;"><canvas width="993" height="1404" style="width: 993px; height: 1404px;"></canvas></div><div class="textLayer" style="width: 992px; height: 1403px;"><span dir="ltr" style="left: 70.8658px; top: 99.677px; font-size: 16.6667px; font-family: sans-serif; transform: scaleX(1.00061);">IET Information Security</span><span dir="ltr" style="left: 70.8658px; top: 149.677px; font-size: 16.6667px; font-family: sans-serif; transform: scaleX(1.00037);">Research Article</span><span dir="ltr" style="left: 70.8658px; top: 197.61px; font-size: 30px; font-family: sans-serif; transform: scaleX(1.07621);">Transforming malicious code to ROP gadgets</span><span dir="ltr" style="left: 70.8658px; top: 230.943px; font-size: 30px; font-family: sans-serif; transform: scaleX(1.09987);">for antivirus evasion</span><span dir="ltr" style="left: 732.286px; top: 198.161px; font-size: 11.6667px; font-family: sans-serif; transform: scaleX(1.00061);">ISSN 1751-8709</span><span dir="ltr" style="left: 732.286px; top: 213.161px; font-size: 11.6667px; font-family: sans-serif; transform: scaleX(1.0006);">Received on 26th July 2018</span><span dir="ltr" style="left: 732.286px; top: 228.161px; font-size: 11.6667px; font-family: sans-serif; transform: scaleX(1.00059);">Revised 22nd February 2019</span><span dir="ltr" style="left: 732.286px; top: 243.161px; font-size: 11.6667px; font-family: sans-serif; transform: scaleX(1.0007);">Accepted on 13th March 2019</span><span dir="ltr" style="left: 732.286px; top: 258.161px; font-size: 11.6667px; font-family: sans-serif; transform: scaleX(1.00074);">E-First on 3rd June 2019</span><span dir="ltr" style="left: 732.286px; top: 273.161px; font-size: 11.6667px; font-family: sans-serif; transform: scaleX(1.00063);">doi: 10.1049/iet-ifs.2018.5386</span><span dir="ltr" style="left: 732.286px; top: 288.161px; font-size: 11.6667px; font-family: sans-serif; transform: scaleX(1.00061);">www.ietdl.org</span><span dir="ltr" style="left: 70.8658px; top: 316.294px; font-size: 18.3333px; font-family: sans-serif; transform: scaleX(1.00002);">Christoforos Ntantogian</span><span dir="ltr" style="left: 263.462px; top: 316.748px; font-size: 11.6667px; font-family: sans-serif;">1</span><span dir="ltr" style="left: 269.949px; top: 316.294px; font-size: 18.3333px; font-family: sans-serif; transform: scaleX(1.00006);">, Georgios Poulios</span><span dir="ltr" style="left: 419.756px; top: 316.748px; font-size: 11.6667px; font-family: sans-serif;">1</span><span dir="ltr" style="left: 426.242px; top: 316.294px; font-size: 18.3333px; font-family: sans-serif; transform: scaleX(1.00004);">, Georgios Karopoulos</span><span dir="ltr" style="left: 608.664px; top: 316.748px; font-size: 11.6667px; font-family: sans-serif;">2</span><span dir="ltr" style="left: 615.151px; top: 316.294px; font-size: 18.3333px; font-family: sans-serif; transform: scaleX(1.00014);">, Christos Xenakis</span><span dir="ltr" style="left: 762.893px; top: 316.748px; font-size: 11.6667px; font-family: sans-serif;">1</span><span dir="ltr" style="left: 70.8658px; top: 339.045px; font-size: 10px; font-family: sans-serif;">1</span><span dir="ltr" style="left: 76.4264px; top: 341.318px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00028);">Department of Digital Systems, University of Piraeus, Piraeus, Greece</span><span dir="ltr" style="left: 70.8626px; top: 356.837px; font-size: 10px; font-family: sans-serif;">2</span><span dir="ltr" style="left: 76.4225px; top: 359.109px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00092);">Department of Informatics and Telecommunications, University of Ath</span><span dir="ltr" style="left: 484.982px; top: 359.109px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00034);">ens, Athens, Greece</span><span dir="ltr" style="left: 79.666px; top: 377.443px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00012);"> E-mail: xenakis@unipi.gr</span><span dir="ltr" style="left: 70.873px; top: 409.479px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.10486);">Abstract: </span><span dir="ltr" style="left: 141.624px; top: 409.479px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.01424);">This study advances research in offensive technology by proposing ret</span><span dir="ltr" style="left: 615.812px; top: 409.479px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.01476);">urn oriented programming (ROP) as a means</span><span dir="ltr" style="left: 70.8654px; top: 426.145px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.02392);">to achieve code obfuscation. The key inspiration is that ROP's </span><span dir="ltr" style="left: 497.52px; top: 426.145px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.0184);">unique structure poses various challenges to malware analysis</span><span dir="ltr" style="left: 70.872px; top: 442.812px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.99549);">compared  to  traditional  shellcode  inspection  and  detection. </span><span dir="ltr" style="left: 492.32px; top: 442.812px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.994993);">The  proposed  ROP-based  attack  vector  provides  two  unique</span><span dir="ltr" style="left: 70.872px; top: 459.479px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.00225);">features: (i) the ability to automatically analyse and generat</span><span dir="ltr" style="left: 463.67px; top: 459.479px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.0032);">e equivalent ROP chains for a given code, and (ii) the abili</span><span dir="ltr" style="left: 850.994px; top: 459.479px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.00344);">ty to reuse</span><span dir="ltr" style="left: 70.8687px; top: 476.145px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.07049);">legitimate code found in an executable in the form of ROP </span><span dir="ltr" style="left: 489.585px; top: 476.145px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.06061);">gadgets. To this end, a software tool named ROPInjector was</span><span dir="ltr" style="left: 70.862px; top: 492.812px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.982398);">developed  which,  given  any  piece  of  shellcode  and  any  legit</span><span dir="ltr" style="left: 498.537px; top: 492.812px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.982395);">imate  executable  file,  it  transforms  the  shellcode  to  its  ROP</span><span dir="ltr" style="left: 70.8704px; top: 509.479px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.00891);">equivalent re-using the available code in the executable an</span><span dir="ltr" style="left: 464.674px; top: 509.479px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.01014);">d finally patches the ROP chain infecting the executable. Af</span><span dir="ltr" style="left: 862.259px; top: 509.479px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.00764);">ter trying</span><span dir="ltr" style="left: 70.8687px; top: 526.145px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.02924);">various combinations of evasion techniques, the results show that</span><span dir="ltr" style="left: 519.737px; top: 526.145px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.03282);"> ROPInjector can evade nearly and completely all antivirus</span><span dir="ltr" style="left: 70.8587px; top: 542.812px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.01064);">software employed in the online VirusTotal service, making ROP a</span><span dir="ltr" style="left: 513.822px; top: 542.812px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.01029);">n effective ingredient for code obfuscation. This attack vector</span><span dir="ltr" style="left: 70.872px; top: 559.479px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.999823);">poses a serious threat which malicious actors can take advantage to</span><span dir="ltr" style="left: 524.405px; top: 559.479px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.999887);"> perform cyber-attack campaigns.</span><span dir="ltr" style="left: 70.8658px; top: 620.26px; font-size: 16.6667px; font-family: sans-serif; transform: scaleX(1.20294);">1௑Introduction</span><span dir="ltr" style="left: 70.8658px; top: 646.078px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.907762);">Return  oriented  programming  (ROP)  gained  increased  attention</span><span dir="ltr" style="left: 70.8658px; top: 662.744px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.904092);">during the late 2000s [1] as an advanced stack smashing method to</span><span dir="ltr" style="left: 70.8723px; top: 679.411px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.89433);">bypass  security  mechanisms.  ROP  is  a  rediscovery  of  threaded</span><span dir="ltr" style="left: 70.8645px; top: 696.078px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.919573);">code in which programs typically consist of a chain of addresses in</span><span dir="ltr" style="left: 70.8691px; top: 712.744px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.930254);">the stack pointing to code chunks in the attacked executable or its</span><span dir="ltr" style="left: 70.8678px; top: 729.411px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.918085);">loaded  libraries  each  of  them  ending  with  a  return  instruction.</span><span dir="ltr" style="left: 70.8717px; top: 746.078px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.917351);">These borrowed code chunks are called </span><span dir="ltr" style="left: 320.065px; top: 746.078px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.874267);">gadgets</span><span dir="ltr" style="left: 366.73px; top: 746.078px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.981354);"> and their ‘return’</span><span dir="ltr" style="left: 70.862px; top: 762.744px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.969138);">is in fact a call to the next gadget in the chain. As an analogy to</span><span dir="ltr" style="left: 70.8731px; top: 779.411px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.934313);">regular code, in ROP, gadgets are the ‘instructions’ and esp is the</span><span dir="ltr" style="left: 70.8731px; top: 796.078px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.903727);">program counter.</span><span dir="ltr" style="left: 90.8686px; top: 812.744px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.936264);">Traditionally, the primal usage scenario of ROP has been (and</span><span dir="ltr" style="left: 70.8641px; top: 829.411px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.95372);">still is) software exploitation to bypass non-executable stack and</span><span dir="ltr" style="left: 70.8641px; top: 846.078px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.935362);">heap. Other recent works have proposed ROP for other purposes</span><span dir="ltr" style="left: 70.8706px; top: 862.744px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.965135);">such  as  rootkit  development  [2],  software  watermarking  [3],</span><span dir="ltr" style="left: 70.8706px; top: 879.411px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.928228);">steganography [4], and code integrity verification [5]. In this paper,</span><span dir="ltr" style="left: 70.868px; top: 896.078px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.946525);">we argue that ROP has another field of application which is code</span><span dir="ltr" style="left: 70.8628px; top: 912.744px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.945756);">obfuscation and antivirus (AV) evasion. We leverage the fact that</span><span dir="ltr" style="left: 70.8628px; top: 929.411px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.914048);">ROP  is  Turing  complete  and  therefore  it  can  perform  arbitrary</span><span dir="ltr" style="left: 70.8641px; top: 946.078px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.937412);">computations; thus every shellcode can be transformed to a ROP</span><span dir="ltr" style="left: 70.8706px; top: 962.744px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.927464);">equivalent.  Our  intuition  is  that  ROP's  unique  structure  poses</span><span dir="ltr" style="left: 70.866px; top: 979.411px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.926781);">various  challenges  compared  to  traditional  shellcode  detection</span><span dir="ltr" style="left: 70.8673px; top: 996.078px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.959293);">including verbosity of the gadgets, stack-based chaining, lack of</span><span dir="ltr" style="left: 70.8641px; top: 1012.74px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.951983);">immediates,  and  the  distinction  of  function  calls  and  regular</span><span dir="ltr" style="left: 70.8732px; top: 1029.41px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.944624);">control flow. On top of that, ROP inherently provides polymorphic</span><span dir="ltr" style="left: 70.8706px; top: 1046.08px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.03121);">properties  by  selecting  a  different  equivalent  gadget  for</span><span dir="ltr" style="left: 70.8726px; top: 1062.74px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.957473);">transforming  a  given  instruction  or  by  chaining  the  selected</span><span dir="ltr" style="left: 70.8726px; top: 1079.41px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.952885);">gadgets in a different order. Another benefit of using ROP for AV</span><span dir="ltr" style="left: 70.8765px; top: 1096.08px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.892789);">evasion  is  that  such  borrowed  code  (that  of  gadgets)  is  always</span><span dir="ltr" style="left: 70.8706px; top: 1112.74px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.892706);">benign  and  tested  against  false  positives.  Thus,  considering  the</span><span dir="ltr" style="left: 70.8628px; top: 1129.41px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.914388);">aforementioned challenges, at its core, ROP can be seen as a new</span><span dir="ltr" style="left: 70.8739px; top: 1146.08px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.908839);">method for code obfuscation.</span><span dir="ltr" style="left: 90.8687px; top: 1162.74px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.896254);">Based  on  the  above  observations,  in  this  paper,  we  present</span><span dir="ltr" style="left: 70.8635px; top: 1179.41px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.92673);">ROPInjector, a tool which, given any piece of code (hereafter, also</span><span dir="ltr" style="left: 70.8635px; top: 1196.08px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.892767);">referred  to  as  shellcode)  and  any  non-packed  executable  file,  it</span><span dir="ltr" style="left: 70.8713px; top: 1212.74px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.911174);">transforms the shellcode into its ROP equivalent and patches it into</span><span dir="ltr" style="left: 70.8733px; top: 1229.41px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.994723);">(i.e.  infects)  the  executable  file.  ROPInjector  [6],  which  is</span><span dir="ltr" style="left: 70.87px; top: 1246.08px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.914547);">implemented  in  C/C++  programming  language,  infects  Portable</span><span dir="ltr" style="left: 70.8629px; top: 1262.74px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.957729);">Executables (PEs) for Windows OS. Since it is very common for</span><span dir="ltr" style="left: 70.8687px; top: 1279.41px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.92733);">AVs to detect minor deviations from the typical arrangement of the</span><span dir="ltr" style="left: 514.97px; top: 619.411px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.902682);">file  sections  and  their  characteristics  (e.g.  a  second  executable</span><span dir="ltr" style="left: 514.968px; top: 636.078px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.937911);">section with RWX permissions), besides the transformation of the</span><span dir="ltr" style="left: 514.971px; top: 652.744px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.949955);">code into a non-recognisable, non-recurrent form, the developed</span><span dir="ltr" style="left: 514.969px; top: 669.411px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.89577);">tool addresses several additional issues to achieve evasion, such as</span><span dir="ltr" style="left: 514.961px; top: 686.078px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.957737);">the positioning of the shellcode in the carrier executable and the</span><span dir="ltr" style="left: 514.961px; top: 702.744px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.974901);">way of transferring control to the shellcode. Moreover, we have</span><span dir="ltr" style="left: 514.962px; top: 719.411px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.91851);">performed several experiments to evaluate the effectiveness of the</span><span dir="ltr" style="left: 514.961px; top: 736.078px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.911122);">proposed  tool  by  injecting  shellcodes  to  well-known  executable</span><span dir="ltr" style="left: 514.957px; top: 752.744px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.930216);">files including acrobat reader, firefox, and so on. The high evasion</span><span dir="ltr" style="left: 514.969px; top: 769.411px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.950143);">results show that ROPInjector combined with simple behavioural</span><span dir="ltr" style="left: 514.959px; top: 786.078px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.953114);">anti-profiling techniques can render AV ineffective and incapable</span><span dir="ltr" style="left: 514.968px; top: 802.744px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.889749);">to detect ROP-based malware.</span><span dir="ltr" style="left: 534.964px; top: 819.411px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.904919);">The rest of the paper is organised as follows. Section 2 presents</span><span dir="ltr" style="left: 514.959px; top: 836.078px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.951997);">and  compares  with  ROPInjector  the  related  work.  Section  3</span><span dir="ltr" style="left: 514.961px; top: 852.744px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.92121);">elaborates on the architecture of the proposed ROPInjector and its</span><span dir="ltr" style="left: 514.959px; top: 869.411px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.931941);">functionality details. In Section 4, we analyse experimental results</span><span dir="ltr" style="left: 514.971px; top: 886.078px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.978574);">and in Section 5 we provide a discussion of possible mitigation</span><span dir="ltr" style="left: 514.959px; top: 902.744px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.954279);">techniques and the challenges of ROPInjector. Finally, Section 6</span><span dir="ltr" style="left: 514.959px; top: 919.411px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.881794);">concludes the paper.</span><span dir="ltr" style="left: 514.963px; top: 956.927px; font-size: 16.6667px; font-family: sans-serif; transform: scaleX(1.15203);">2௑Related work</span><span dir="ltr" style="left: 514.971px; top: 982.744px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.932124);">While  the  traditional  use  of  ROP  is  software  exploitation  (i.e.</span><span dir="ltr" style="left: 514.971px; top: 999.411px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.93362);">bypass non-executable stack and heap), there are some previous</span><span dir="ltr" style="left: 514.961px; top: 1016.08px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.995151);">works  that  have  proposed  alternative  uses  of  ROP.  More</span><span dir="ltr" style="left: 514.971px; top: 1032.74px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.950466);">specifically, in [3] the authors propose ROP for benign purposes;</span><span dir="ltr" style="left: 514.96px; top: 1049.41px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.983495);">specifically,  they  use  ROP  for  software  watermarking.  The</span><span dir="ltr" style="left: 514.958px; top: 1066.08px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.02603);">proposed  ROP-based  watermarking  is  able  to  transform</span><span dir="ltr" style="left: 514.961px; top: 1082.74px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.953943);">watermarking code into ROP gadgets and build them in the data</span><span dir="ltr" style="left: 514.961px; top: 1099.41px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.904366);">region. Once triggered using a secret message, the pre-constructed</span><span dir="ltr" style="left: 514.971px; top: 1116.08px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.950138);">ROP execution will recover the hidden watermark message. The</span><span dir="ltr" style="left: 514.967px; top: 1132.74px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.921335);">proposed method ensures that the watermarked program does not</span><span dir="ltr" style="left: 514.969px; top: 1149.41px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.00919);">have  an  explicit  code  stream  that  belongs  exclusively  to</span><span dir="ltr" style="left: 514.961px; top: 1166.08px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.901025);">watermarking. Instead, the authors use operating system libraries to</span><span dir="ltr" style="left: 514.972px; top: 1182.74px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.9708);">borrow  the  ROP  gadgets,  preventing  detection  by  software</span><span dir="ltr" style="left: 514.964px; top: 1199.41px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.90547);">analysis. Towards this direction, RopSteg [4] has been proposed for</span><span dir="ltr" style="left: 514.964px; top: 1216.08px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.947203);">program  steganography.  The  latter  is  a  variation  of  software</span><span dir="ltr" style="left: 514.972px; top: 1232.74px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.952601);">obfuscation but it differs from it, since in program steganography</span><span dir="ltr" style="left: 514.965px; top: 1249.41px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.929998);">the instructions are hidden instead of being transformed. RopSteg</span><span dir="ltr" style="left: 514.972px; top: 1266.08px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.917979);">achieves to hide selected code protection by generating equivalent</span><span dir="ltr" style="left: 514.963px; top: 1282.74px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.944604);">ROP gadgets and blending them into the executable. Both works</span><span dir="ltr" style="left: 70.8744px; top: 1320.58px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00354);">IET Inf. Secur.</span><span dir="ltr" style="left: 155.594px; top: 1320.58px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00037);">, 2019, Vol. 13 Iss. 6, pp. 570-578</span><span dir="ltr" style="left: 70.8744px; top: 1338.91px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00018);">© The Institution of Engineering and Technology 2019</span><span dir="ltr" style="left: 899.021px; top: 1320.58px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999841);">570</span><div class="endOfContent active" style=""></div></div><div class="annotationLayer"><section data-annotation-id="140R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -124.626px -397.958px; left: 124.626px; top: 397.958px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A67%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C218.09%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="141R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -164.48px -517.958px; left: 164.48px; top: 517.958px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A67%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C194.09%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="142R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -276.552px -517.958px; left: 276.552px; top: 517.958px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A67%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C178.09%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="143R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -100.387px -527.958px; left: 100.387px; top: 527.958px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A67%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C154.09%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="144R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -227.018px -527.958px; left: 227.018px; top: 527.958px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A67%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C130.09%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="145R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -235.341px -737.958px; left: 235.341px; top: 737.958px; width: 4.5px; height: 8.9996px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A67%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C98.0898%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="146R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -368.822px -619.958px; left: 368.822px; top: 619.958px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A67%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C178.09%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="147R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -463.692px -719.958px; left: 463.692px; top: 719.958px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A67%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C154.09%2Cnull%5D" class="internalLink"></a></section></div></div><div class="page" data-page-number="2" role="region" style="width: 992px; height: 1403px;" data-loaded="true"><div class="canvasWrapper" style="width: 992px; height: 1403px;"><canvas width="993" height="1404" style="width: 993px; height: 1404px;"></canvas></div><div class="textLayer" style="width: 992px; height: 1403px;"><span dir="ltr" style="left: 70.8658px; top: 336.819px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.970913);">[3, 4] are reminiscent of ROPInjector as they take advantage of</span><span dir="ltr" style="left: 70.8619px; top: 353.486px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.93715);">ROP to hide a message or a piece of code inside a PE. However,</span><span dir="ltr" style="left: 70.8587px; top: 370.152px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.950006);">none of these two solutions evaluate the detection capabilities of</span><span dir="ltr" style="left: 70.8704px; top: 386.819px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.914812);">ROP, as their main intention is the use of ROP for benign purposes</span><span dir="ltr" style="left: 70.8704px; top: 403.486px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.904814);">such  as  software  watermarking  and  steganography.  In  addition,</span><span dir="ltr" style="left: 70.8665px; top: 420.152px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.923278);">these  solutions  do  not  release  a  tool  to  further  evaluate  their</span><span dir="ltr" style="left: 70.8704px; top: 436.819px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.01198);">capabilities.  Finally,  ROPOB  [7]  is  a  code  transformation</span><span dir="ltr" style="left: 70.8723px; top: 453.486px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.991326);">technique  to  obfuscate  control  flow  using  ROP.  The  main</span><span dir="ltr" style="left: 70.8697px; top: 470.152px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.942619);">contribution of ROPOB is that due to the use of ROP to complete</span><span dir="ltr" style="left: 70.8678px; top: 486.819px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.902719);">control  flow  transfer,  static  reverse  engineering  methods  cannot</span><span dir="ltr" style="left: 70.8678px; top: 503.486px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.944594);">easily discover the real control flow of the program. However, the</span><span dir="ltr" style="left: 70.8619px; top: 520.152px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.98289);">main limitation of ROPOB is that through dynamic analysis the</span><span dir="ltr" style="left: 70.86px; top: 536.819px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.932467);">obfuscation trivially breaks.</span><span dir="ltr" style="left: 90.8705px; top: 553.486px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.951601);">A similar work to ROPInjector is presented in [8], in which the</span><span dir="ltr" style="left: 70.8653px; top: 570.152px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.988503);">authors leverage ROP to hide malicious code in a PE file. The</span><span dir="ltr" style="left: 70.8653px; top: 586.819px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.899196);">novel  idea  is  to  encrypt  the  ROP  chain  to  avoid  detection  and</span><span dir="ltr" style="left: 70.8673px; top: 603.486px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.955736);">remotely trigger the ROP execution at the runtime. Although this</span><span dir="ltr" style="left: 70.8718px; top: 620.152px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.91616);">idea is interesting, the encryption itself can raise suspicions, due to</span><span dir="ltr" style="left: 70.8614px; top: 636.819px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.918423);">high  entropy,  while  a  proper  key  management  solution  always</span><span dir="ltr" style="left: 70.8673px; top: 653.486px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.911481);">requires  extra  effort.  Nonetheless,  the  solution  described  in  [8]</span><span dir="ltr" style="left: 70.8718px; top: 670.152px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.895994);">presents  yet  another  interesting  use  case  of  ROP  for  malicious</span><span dir="ltr" style="left: 70.8738px; top: 686.819px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.884335);">purposes.  The  work  closest  to  ours  is  presented  by  Mohan  and</span><span dir="ltr" style="left: 70.8666px; top: 703.486px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.906025);">Hamlen [9]. The authors have developed a metamorphic obfuscator</span><span dir="ltr" style="left: 70.8725px; top: 720.152px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.941015);">called Frankenstein which is able to reassemble a given malware</span><span dir="ltr" style="left: 70.8634px; top: 736.819px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.924823);">with code fragments entirely from other benign programs. Authors’</span><span dir="ltr" style="left: 70.8653px; top: 753.486px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.914566);">motivation  was  the  creation  of  malware  variations  from  benign</span><span dir="ltr" style="left: 70.8692px; top: 770.152px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.940925);">pieces of entirely randomly selected binaries residing in a system</span><span dir="ltr" style="left: 70.8607px; top: 786.819px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.916159);">to avoid signature matching detection. They deduce the problem of</span><span dir="ltr" style="left: 70.8744px; top: 803.486px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.909276);">generating  mutations  into  a  searching  problem.  Their  proposed</span><span dir="ltr" style="left: 70.8731px; top: 820.152px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.980602);">method is able to search for segments of code found in benign</span><span dir="ltr" style="left: 70.8601px; top: 836.819px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.946588);">binaries and evaluate them semantically with the given malicious</span><span dir="ltr" style="left: 70.8692px; top: 853.486px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.930796);">instructions. Finally, it performs the suitable code arrangements to</span><span dir="ltr" style="left: 70.8725px; top: 870.152px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.921809);">construct the final payload. Frankenstein differs from our proposed</span><span dir="ltr" style="left: 70.8601px; top: 886.819px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.906046);">ROPInjector  in  several  aspects.  First,  Frankenstein  considers  a</span><span dir="ltr" style="left: 70.8699px; top: 903.486px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.942945);">relaxed version of a gadget. That is, while in the classic definition</span><span dir="ltr" style="left: 70.8634px; top: 920.152px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.959341);">of ROP [10], a gadget ends with the </span><span dir="ltr" style="left: 304.608px; top: 920.152px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.920449);">ret</span><span dir="ltr" style="left: 320.718px; top: 920.152px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.933734);"> instruction, Frankenstein</span><span dir="ltr" style="left: 70.8601px; top: 936.819px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.900438);">definition of a gadget is any sequence of bytes that are interpretable</span><span dir="ltr" style="left: 70.8601px; top: 953.486px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.965738);">as valid x86 instructions. On the contrary, ROPInjector relies on</span><span dir="ltr" style="left: 70.8737px; top: 970.152px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.994532);">the  pure  and  original  definition  of  ROP  gadgets.  Second,</span><span dir="ltr" style="left: 70.8711px; top: 986.819px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.939023);">Frankenstein main purpose is to modify only code snippets which</span><span dir="ltr" style="left: 70.8692px; top: 1003.49px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.93367);">may  look  suspicious,  while  ROPInjector  transforms  the  whole</span><span dir="ltr" style="left: 70.8594px; top: 1020.15px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.957513);">shellcode  to  the  ROP  counterpart.  Third,  authors  have  only</span><span dir="ltr" style="left: 70.862px; top: 1036.82px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.926825);">implemented a proof of concept (which is not available publicly).</span><span dir="ltr" style="left: 90.8718px; top: 1053.49px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.911259);">Finally,  we  examine  two  non-academic  works  that  have  the</span><span dir="ltr" style="left: 70.8673px; top: 1070.15px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.998931);">same purpose with ROPInjector; that is, to infect PE files with</span><span dir="ltr" style="left: 70.8725px; top: 1086.82px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.916837);">common  (possibly  encrypted)  shellcode  in  order  to  bypass  AV</span><span dir="ltr" style="left: 70.8615px; top: 1103.49px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.910285);">software.</span><span dir="ltr" style="left: 90.8713px; top: 1120.15px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.967363);">The first tool named Shellter [11] focuses on maintaining the</span><span dir="ltr" style="left: 70.8726px; top: 1136.82px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.952004);">original  structure  of  the  PE  file,  by  avoiding  injection  of  the</span><span dir="ltr" style="left: 70.8622px; top: 1153.49px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.928394);">shellcode into predefined locations or changing the characteristics</span><span dir="ltr" style="left: 70.8603px; top: 1170.15px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.923094);">of the existing sections. It achieves so by overwriting existing code</span><span dir="ltr" style="left: 70.87px; top: 1186.82px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.942651);">for which it is certain that will be given control during execution of</span><span dir="ltr" style="left: 70.8642px; top: 1203.49px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.959398);">the program. The latter is deduced by tracing the executable file</span><span dir="ltr" style="left: 70.8694px; top: 1220.15px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.917805);">and analysing its execution flow. Shellter is also capable of reusing</span><span dir="ltr" style="left: 70.8674px; top: 1236.82px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.935589);">imports of the original PE file to change the writing permissions of</span><span dir="ltr" style="left: 70.8655px; top: 1253.49px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.890902);">the  section  containing  the  shellcode  so  that  encrypted  and  self-</span><span dir="ltr" style="left: 70.8713px; top: 1270.15px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.972899);">modifying code can be used. It is also capable of injecting ‘junk</span><span dir="ltr" style="left: 70.8733px; top: 1286.82px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.899122);">code’ before the shellcode that delays execution as a means to anti-</span><span dir="ltr" style="left: 514.965px; top: 81.6489px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.948316);">emulation. Shellter is advanced in terms of dynamically selecting</span><span dir="ltr" style="left: 514.954px; top: 98.3156px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.923165);">the location of the patch in the shellcode (as opposed to extending</span><span dir="ltr" style="left: 514.96px; top: 114.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.919815);">the text section). However, while it features a patching method that</span><span dir="ltr" style="left: 514.957px; top: 131.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.93215);">introduces  variability  (as  to  where  in  the  file  is  the  shellcode</span><span dir="ltr" style="left: 514.964px; top: 148.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.965223);">injected), it relies on traditional polymorphism methods, that are</span><span dir="ltr" style="left: 514.966px; top: 164.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.988776);">still  subject  to  signature  generation  and  detection  of  write</span><span dir="ltr" style="left: 514.958px; top: 181.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.964092);">permissions  or  modifications  of  the  text  section  in  memory.</span><span dir="ltr" style="left: 514.967px; top: 198.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.911855);">Moreover, our proposed approach can introduce variability too, due</span><span dir="ltr" style="left: 514.967px; top: 214.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.912499);">to the transformation to ROP (which is dependent on the PE file).</span><span dir="ltr" style="left: 534.962px; top: 231.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.919382);">The second tool is PEinject [12], which is mostly a method (and</span><span dir="ltr" style="left: 514.955px; top: 248.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.963446);">referenced as such) rather than a full-featured tool. It injects the</span><span dir="ltr" style="left: 514.964px; top: 264.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.927126);">shellcode in the (first sufficiently large) padding space found in the</span><span dir="ltr" style="left: 514.955px; top: 281.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.944715);">text section (either 0xCC caves or section padding) and does not</span><span dir="ltr" style="left: 514.964px; top: 298.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.920332);">encode or modify the payload in any way, neither does it anticipate</span><span dir="ltr" style="left: 514.96px; top: 314.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.94081);">for self-modifying or encrypted payloads. Control is passed to the</span><span dir="ltr" style="left: 514.96px; top: 331.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.961316);">injected shellcode by modifying the address of entry point of the</span><span dir="ltr" style="left: 514.96px; top: 348.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.952283);">PE file's NT_HEADER.</span><span dir="ltr" style="left: 534.955px; top: 364.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.922893);">A common limitation of the aforementioned related works is the</span><span dir="ltr" style="left: 514.96px; top: 381.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.06204);">limited  applicability  and  practicability  of  their  proposed</span><span dir="ltr" style="left: 514.964px; top: 398.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.971441);">techniques.  For  instance,  Borrello </span><span dir="ltr" style="left: 757.048px; top: 398.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.05957);">et  al.</span><span dir="ltr" style="left: 795.916px; top: 398.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.0514);">  [8]  discuss  only</span><span dir="ltr" style="left: 514.961px; top: 414.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.966561);">theoretically the proposed solution, while Lu </span><span dir="ltr" style="left: 802.667px; top: 414.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.998864);">et al.</span><span dir="ltr" style="left: 835.126px; top: 414.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.983983);"> [4] present a</span><span dir="ltr" style="left: 514.962px; top: 431.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.933553);">proof  of  concept  which  has  been  manually  prepared  only  for</span><span dir="ltr" style="left: 514.963px; top: 448.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.9592);">evaluation purposes. On the other hand, Mohan and Hamlen [9]</span><span dir="ltr" style="left: 514.958px; top: 464.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.974648);">apply the proposed techniques only to a very limited number of</span><span dir="ltr" style="left: 514.97px; top: 481.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.924813);">code snippets. In contrast to all other previous works, ROPInjector</span><span dir="ltr" style="left: 514.965px; top: 498.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.986601);">is  the  first  tool  released  as  open  source  that  exploits  the</span><span dir="ltr" style="left: 514.959px; top: 514.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.909404);">polymorphic  properties  of  ROP  for  advanced  code  obfuscation.</span><span dir="ltr" style="left: 514.956px; top: 531.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.939065);">ROPInjector has been designed to be generic and scalable in the</span><span dir="ltr" style="left: 514.969px; top: 548.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.902354);">sense  that  given  as  an  input  any  functional  shellcode  and  any</span><span dir="ltr" style="left: 514.966px; top: 564.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.935843);">legitimate executable, it will produce an executable that will reta</span><span dir="ltr" style="left: 909.708px; top: 564.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.999805);">in</span><span dir="ltr" style="left: 514.964px; top: 581.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.971092);">its legitimate functionality bundled with the malicious shellcode.</span><span dir="ltr" style="left: 514.959px; top: 598.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.99756);">Finally, ROPInjector is fully automated and no manual work is</span><span dir="ltr" style="left: 514.964px; top: 614.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.907695);">required.</span><span dir="ltr" style="left: 514.961px; top: 652.498px; font-size: 16.6667px; font-family: sans-serif; transform: scaleX(1.15264);">3௑ROPInjector</span><span dir="ltr" style="left: 514.961px; top: 678.382px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.999636);">3.1 High-level overview</span><span dir="ltr" style="left: 514.961px; top: 704.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.902643);">ROPInjector takes as an input a benign PE and a malicious piece of</span><span dir="ltr" style="left: 514.961px; top: 721.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.9128);">code (i.e. shellcode) and outputs the PE infected with the malicious</span><span dir="ltr" style="left: 514.97px; top: 738.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.961275);">piece  of  code  in  a  ROP  form  (see  Fig.  1).  In  general,  the</span><span dir="ltr" style="left: 514.966px; top: 754.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.948237);">ROPInjector approach can be divided into five distinct phases as</span><span dir="ltr" style="left: 514.96px; top: 771.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.983117);">follows:</span><span dir="ltr" style="left: 514.96px; top: 804.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.934621);">i.  Reverse analysis of machine code</span><span dir="ltr" style="left: 514.96px; top: 823.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.961877);">ii. Finding ROP gadgets in PE</span><span dir="ltr" style="left: 514.96px; top: 841.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.942408);">iii. ROP compilation and injecting gadgets</span><span dir="ltr" style="left: 514.96px; top: 859.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.96135);">iv. Chaining gadgets</span><span dir="ltr" style="left: 514.96px; top: 878.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.949232);">v. Passing control to the shellcode</span><span dir="ltr" style="left: 534.97px; top: 911.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.939895);">These phases are executed sequentially one after the other. If</span><span dir="ltr" style="left: 514.961px; top: 928.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.912768);">any of the above phases fail to complete, then ROPInjector outputs</span><span dir="ltr" style="left: 514.957px; top: 944.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.957417);">an error message describing the cause of the failure. In the next</span><span dir="ltr" style="left: 514.97px; top: 961.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.924617);">sections,  we  are  going  to  analyse  each  of  the  above  phases</span><span dir="ltr" style="left: 514.972px; top: 978.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.942849);">providing detailed examples to gain a better understanding of the</span><span dir="ltr" style="left: 514.965px; top: 994.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.884494);">presented notions.</span><span dir="ltr" style="left: 514.965px; top: 1031.72px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.999771);">3.2 Reverse analysis of machine code</span><span dir="ltr" style="left: 514.965px; top: 1058.32px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.900989);">Reverse analysis of machine code into data structures that are easy</span><span dir="ltr" style="left: 514.971px; top: 1074.98px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.935578);">to handle is crucial to perform any kind of patching, modifications,</span><span dir="ltr" style="left: 514.962px; top: 1091.65px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.893898);">re-assembly,  and  any  transformation  to  ROP.  Two  are  the  most</span><span dir="ltr" style="left: 514.969px; top: 1108.32px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.980717);">important  pieces  of  information  required:  (i)  the  origin  and</span><span dir="ltr" style="left: 514.958px; top: 1124.98px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.967302);">destination of all relative references (e.g. a relative jump and its</span><span dir="ltr" style="left: 514.963px; top: 1141.65px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.990781);">target) and (ii) which registers are being written or read during</span><span dir="ltr" style="left: 514.96px; top: 1158.32px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.929274);">each instruction, as well as which registers are free to modify. The</span><span dir="ltr" style="left: 514.957px; top: 1174.98px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.995034);">former is required for injecting or removing instructions from a</span><span dir="ltr" style="left: 514.967px; top: 1191.65px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.94727);">code  segment  without  breaking  its  functionality.  The  latter  is</span><span dir="ltr" style="left: 514.961px; top: 1208.32px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.00298);">particularly  useful  to  enhance  gadget  matching,  either  by</span><span dir="ltr" style="left: 514.969px; top: 1224.98px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.984684);">performing  permutations,  or  by  using  gadgets  that  contain</span><span dir="ltr" style="left: 514.959px; top: 1241.65px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.882843);">redundant  but  safe  instructions  (in  this  case,  unsafe  are  branch,</span><span dir="ltr" style="left: 514.962px; top: 1258.32px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.942706);">privileged, or indirect addressing mode instructions because they</span><span dir="ltr" style="left: 514.962px; top: 1274.98px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.900443);">risk raising errors such as access violation).</span><span dir="ltr" style="left: 70.8658px; top: 304.378px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.02759);">Fig. 1௒</span><span dir="ltr" style="left: 113.466px; top: 304.378px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.942854);">ROPInjector high-level functionality</span><span dir="ltr" style="left: 70.8597px; top: 1320.58px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00354);">IET Inf. Secur.</span><span dir="ltr" style="left: 155.593px; top: 1320.58px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.0003);">, 2019, Vol. 13 Iss. 6, pp. 570-578</span><span dir="ltr" style="left: 70.8597px; top: 1338.92px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00022);">© The Institution of Engineering and Technology 2019</span><span dir="ltr" style="left: 899.02px; top: 1320.58px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999841);">571</span><div class="endOfContent"></div></div><div class="annotationLayer"><section data-annotation-id="2R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -45.5168px -202.402px; left: 45.5168px; top: 202.402px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A67%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C178.09%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="3R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -56.1284px -202.402px; left: 56.1284px; top: 202.402px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A67%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C154.09%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="4R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -168.6px -262.402px; left: 168.6px; top: 262.402px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A80%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C793.09%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="5R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -228.633px -332.402px; left: 228.633px; top: 332.402px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A80%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C769.09%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="6R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -278.802px -392.402px; left: 278.802px; top: 392.402px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A80%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C769.09%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="7R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -76.3342px -422.402px; left: 76.3342px; top: 422.402px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A80%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C745.09%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="8R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -77.1525px -552.402px; left: 77.1525px; top: 552.402px; width: 9px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A80%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C721.09%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="9R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -170.139px -672.402px; left: 170.139px; top: 672.402px; width: 8.666px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A80%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C697.09%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="10R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -425.078px -139.3px; left: 425.078px; top: 139.3px; width: 9px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A80%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C681.09%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="11R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -488.114px -239.3px; left: 488.114px; top: 239.3px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A80%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C769.09%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="12R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -507.807px -249.3px; left: 507.807px; top: 249.3px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A67%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C154.09%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="13R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -545.259px -269.3px; left: 545.259px; top: 269.3px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A80%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C745.09%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="14R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -478.636px -443.3px; left: 478.636px; top: 443.3px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A1%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C792.59%2Cnull%5D" class="internalLink"></a></section></div></div><div class="page" data-page-number="3" role="region" style="width: 992px; height: 1403px;" data-loaded="true"><div class="canvasWrapper" style="width: 992px; height: 1403px;"><canvas width="993" height="1404" style="width: 993px; height: 1404px;"></canvas></div><div class="textLayer" style="width: 992px; height: 1403px;"><span dir="ltr" style="left: 70.8658px; top: 81.7156px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.16309);">3.2.1  MOD/REG/RM  and  scaled  index  byte  (SIB)</span><span dir="ltr" style="left: 70.8658px; top: 98.3823px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.999569);">unrolling: </span><span dir="ltr" style="left: 148.328px; top: 98.3823px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.04644);">Instructions  using  the  MOD/REG/RM  indirect</span><span dir="ltr" style="left: 70.8632px; top: 115.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.916141);">addressing mode with displacement or the SIB addressing scheme</span><span dir="ltr" style="left: 70.8651px; top: 131.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.942825);">in the shellcode are treated specially before the transformation to</span><span dir="ltr" style="left: 70.8684px; top: 148.382px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.909604);">ROP. Such instructions are unwanted for the following reasons:</span><span dir="ltr" style="left: 70.8684px; top: 181.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.933911);">i.  They are long (in the best and not so likely case 3 bytes long: 1</span><span dir="ltr" style="left: 95.8729px; top: 198.382px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.973002);">for  opcode,  1  for  MOD/REG/RM  and  1  for  SIB)  hence</span><span dir="ltr" style="left: 95.8631px; top: 215.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.9208);">unlikely to be found in gadgets;</span><span dir="ltr" style="left: 70.8729px; top: 233.382px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.955734);">ii. They often read many general purpose registers at once, thus</span><span dir="ltr" style="left: 95.8586px; top: 250.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.955059);">reserving them while as mentioned earlier, the more the free</span><span dir="ltr" style="left: 95.8729px; top: 266.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.889871);">registers the better;</span><span dir="ltr" style="left: 70.8678px; top: 285.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.935198);">iii. Their respective gadgets (should they be found or injected) will</span><span dir="ltr" style="left: 95.8729px; top: 301.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.937086);">probably not be reusable, due to the use of displacement and</span><span dir="ltr" style="left: 95.8716px; top: 318.382px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.891264);">index constants (e.g. </span><span dir="ltr" style="left: 222.922px; top: 318.382px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.922161);">mov edx, [esi*2</span><span dir="ltr" style="left: 320.482px; top: 318.382px; font-size: 15px; font-family: sans-serif;">+</span><span dir="ltr" style="left: 333.607px; top: 318.382px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.999067);">16]</span><span dir="ltr" style="left: 354.442px; top: 318.382px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.954424);">).</span><span dir="ltr" style="left: 70.867px; top: 351.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.916385);">In  order  to  circumvent  this  kind  of  situations,  we  reduce  such</span><span dir="ltr" style="left: 70.8689px; top: 368.382px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.923798);">instructions to their arithmetic equivalents one-by-one. We call this</span><span dir="ltr" style="left: 70.8585px; top: 385.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.85968);">process </span><span dir="ltr" style="left: 121.555px; top: 385.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.974888);">unrolling</span><span dir="ltr" style="left: 176.83px; top: 385.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.960844);"> and it is performed to the shellcode before any</span><span dir="ltr" style="left: 70.867px; top: 401.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.93282);">transformation to ROP. For instance, </span><span dir="ltr" style="left: 302.312px; top: 401.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.929692);">mov eax, [ebx</span><span dir="ltr" style="left: 392.115px; top: 401.716px; font-size: 15px; font-family: sans-serif;">+</span><span dir="ltr" style="left: 405.24px; top: 401.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.979131);">ecx*2]</span><span dir="ltr" style="left: 446.04px; top: 401.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.957674);"> may</span><span dir="ltr" style="left: 70.8582px; top: 418.382px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.889006);">be replaced by</span><span dir="ltr" style="left: 70.8582px; top: 451.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.00143);">[a′] </span><span dir="ltr" style="left: 94.543px; top: 451.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.890819);">Mov eax, ecx</span><span dir="ltr" style="left: 70.8582px; top: 470.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.03684);">[b′] </span><span dir="ltr" style="left: 95.3828px; top: 470.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.889035);">sal eax, 1</span><span dir="ltr" style="left: 70.8582px; top: 488.382px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.0384);">[c′] </span><span dir="ltr" style="left: 94.543px; top: 488.382px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.877771);">add eax, ebx</span><span dir="ltr" style="left: 70.8582px; top: 506.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.03684);">[d′] </span><span dir="ltr" style="left: 95.3828px; top: 506.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.91809);">mov eax, [eax]</span><span dir="ltr" style="left: 70.8582px; top: 540.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.95878);">If the register </span><span dir="ltr" style="left: 160.462px; top: 540.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.861068);">eax</span><span dir="ltr" style="left: 181.267px; top: 540.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.956743);"> is not free to use for the arithmetic operations,</span><span dir="ltr" style="left: 70.864px; top: 556.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.894383);">another temporary register that is free may be used.</span><span dir="ltr" style="left: 90.8588px; top: 573.382px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.949695);">Noteworthy is how unrolling unlocks register access from one</span><span dir="ltr" style="left: 70.8633px; top: 590.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.970562);">atomic instruction to many. For instance, in the example, </span><span dir="ltr" style="left: 440.65px; top: 590.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.85625);">ecx</span><span dir="ltr" style="left: 460.63px; top: 590.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.10229);"> is</span><span dir="ltr" style="left: 70.8582px; top: 606.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.926135);">freed at [a′] and </span><span dir="ltr" style="left: 171.294px; top: 606.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.861068);">ebx</span><span dir="ltr" style="left: 192.114px; top: 606.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.963029);"> at [c′]. If, for example, </span><span dir="ltr" style="left: 338.222px; top: 606.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.861068);">eax</span><span dir="ltr" style="left: 359.042px; top: 606.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.914204);"> were to be freed at</span><span dir="ltr" style="left: 70.8723px; top: 623.382px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.937874);">the preceding 10 instructions, then instructions [a′] to [c′] could be</span><span dir="ltr" style="left: 70.8613px; top: 640.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.950025);">moved 10 instructions behind, thus resulting in an additional free</span><span dir="ltr" style="left: 70.8593px; top: 656.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.913387);">register (i.e. </span><span dir="ltr" style="left: 147.294px; top: 656.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.856251);">ecx</span><span dir="ltr" style="left: 167.259px; top: 656.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.883566);"> and </span><span dir="ltr" style="left: 197.049px; top: 656.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.861068);">ebx</span><span dir="ltr" style="left: 217.854px; top: 656.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.924645);">, but not </span><span dir="ltr" style="left: 272.131px; top: 656.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.861068);">eax</span><span dir="ltr" style="left: 292.952px; top: 656.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.952757);"> which will not be free) in that</span><span dir="ltr" style="left: 70.8616px; top: 673.382px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.897002);">preceding code chunk.</span><span dir="ltr" style="left: 70.8616px; top: 710.115px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.999731);">3.3 Finding gadgets</span><span dir="ltr" style="left: 70.8616px; top: 736.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.941047);">Candidate gadgets in the executable sections of the given PE file</span><span dir="ltr" style="left: 70.8577px; top: 753.382px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.927545);">must end in one of the following instructions:</span><span dir="ltr" style="left: 70.8577px; top: 786.716px; font-size: 15px; font-family: sans-serif;">•</span><span dir="ltr" style="left: 87.5381px; top: 786.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.919594);">ret</span><span dir="ltr" style="left: 103.633px; top: 786.716px; font-size: 15px; font-family: sans-serif;">,</span><span dir="ltr" style="left: 70.8578px; top: 805.049px; font-size: 15px; font-family: sans-serif;">•</span><span dir="ltr" style="left: 87.5381px; top: 805.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.912958);">retn</span><span dir="ltr" style="left: 111.133px; top: 805.049px; font-size: 15px; font-family: sans-serif;">,</span><span dir="ltr" style="left: 70.8578px; top: 823.382px; font-size: 15px; font-family: sans-serif;">•</span><span dir="ltr" style="left: 87.5381px; top: 823.382px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.900777);">pop regX,</span><span dir="ltr" style="left: 70.8578px; top: 841.716px; font-size: 15px; font-family: sans-serif;">•</span><span dir="ltr" style="left: 87.5381px; top: 841.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.913703);">jmp regX</span><span dir="ltr" style="left: 142.378px; top: 841.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.91893);">, or </span><span dir="ltr" style="left: 166.123px; top: 841.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.913952);">jmp regX</span><span dir="ltr" style="left: 220.978px; top: 841.716px; font-size: 15px; font-family: sans-serif;">.</span><span dir="ltr" style="left: 70.8578px; top: 875.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.982801);">Exceptionally for the latter, the gadget in question must be first</span><span dir="ltr" style="left: 70.8702px; top: 891.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.952931);">paired with a </span><span dir="ltr" style="left: 157.347px; top: 891.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.928922);">loader gadget</span><span dir="ltr" style="left: 242.552px; top: 891.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.922568);"> that loads the required return address</span><span dir="ltr" style="left: 70.8633px; top: 908.382px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.955664);">into </span><span dir="ltr" style="left: 100.355px; top: 908.382px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.902876);">regX</span><span dir="ltr" style="left: 128.945px; top: 908.382px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.960047);">. The process begins by finding all gadget endings and</span><span dir="ltr" style="left: 70.8672px; top: 925.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.983304);">temporarily storing them to a list. For each of those endings, </span><span dir="ltr" style="left: 469.665px; top: 925.049px; font-size: 15px; font-family: sans-serif;">n</span><span dir="ltr" style="left: 70.8605px; top: 941.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.898519);">bytes of preceding machine code are disassembled for each </span><span dir="ltr" style="left: 434.547px; top: 941.716px; font-size: 15px; font-family: sans-serif;">n</span><span dir="ltr" style="left: 442.047px; top: 941.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.923341);"> up to</span><span dir="ltr" style="left: 70.8572px; top: 958.382px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.926073);">maximum depth </span><span dir="ltr" style="left: 174.481px; top: 958.382px; font-size: 15px; font-family: sans-serif;">N</span><span dir="ltr" style="left: 184.485px; top: 958.382px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.941508);"> (typically 20 bytes). If such disassembly aligns</span><span dir="ltr" style="left: 70.8649px; top: 975.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.926597);">with  the  ending  (not  guaranteed  since  x86  instructions  are  of</span><span dir="ltr" style="left: 70.8571px; top: 991.716px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.899049);">variable  length)  a  candidate  gadget  has  been  found.  Candidate</span><span dir="ltr" style="left: 70.8649px; top: 1008.38px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.947742);">gadgets containing any illegal, privileged (e.g. </span><span dir="ltr" style="left: 364.337px; top: 1008.38px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.953022);">sysenter, int, iret</span><span dir="ltr" style="left: 468.421px; top: 1008.38px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.954424);">),</span><span dir="ltr" style="left: 70.8605px; top: 1025.05px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.900468);">branch or </span><span dir="ltr" style="left: 131.67px; top: 1025.05px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.826762);">esp</span><span dir="ltr" style="left: 151.665px; top: 1025.05px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.933614);"> modifying instructions are filtered out.</span><span dir="ltr" style="left: 514.955px; top: 81.7156px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.999747);">3.4 ROP compilation and injecting gadgets</span><span dir="ltr" style="left: 514.955px; top: 108.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.904119);">The gadgets found in the aforementioned process are first analysed</span><span dir="ltr" style="left: 514.951px; top: 124.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.909539);">instruction-by-instruction to infer register access. Since gadgets are</span><span dir="ltr" style="left: 514.952px; top: 141.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.965225);">allowed to contain safe but redundant instructions, their register</span><span dir="ltr" style="left: 514.954px; top: 158.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.952141);">access is tested for modifications to the register in question (e.g.</span><span dir="ltr" style="left: 514.953px; top: 174.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.927817);">mov ecx, eax; pop ecx; ret</span><span dir="ltr" style="left: 677.339px; top: 174.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.927893);">; gadget cannot be used for moving </span><span dir="ltr" style="left: 900.437px; top: 174.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.861068);">eax</span><span dir="ltr" style="left: 514.952px; top: 191.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.924764);">to </span><span dir="ltr" style="left: 531.048px; top: 191.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.85625);">ecx</span><span dir="ltr" style="left: 551.028px; top: 191.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.921469);">) as well as the non-free registers of the source instruction to</span><span dir="ltr" style="left: 514.963px; top: 208.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.867704);">be encoded.</span><span dir="ltr" style="left: 534.958px; top: 224.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.0854);">Following  that,  they  are  lifted  into  an  intermediate</span><span dir="ltr" style="left: 514.965px; top: 241.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.935585);">representation  (IR)  consisting  of  an  operation-type,  and  three</span><span dir="ltr" style="left: 514.959px; top: 258.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.932544);">operands with different meaning depending on the type. If a multi-</span><span dir="ltr" style="left: 514.961px; top: 274.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.01526);">instruction  gadget  contains  more  than  one  representable</span><span dir="ltr" style="left: 514.961px; top: 291.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.976854);">instructions, only the first is considered. However, the following</span><span dir="ltr" style="left: 514.959px; top: 308.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.957283);">ones have also been considered in other gadgets with the same</span><span dir="ltr" style="left: 514.966px; top: 324.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.899025);">ending, because of the backwards gadget finding process described</span><span dir="ltr" style="left: 514.951px; top: 341.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.955713);">in the previous paragraph. Noteworthy is the fact that by parsing</span><span dir="ltr" style="left: 514.956px; top: 358.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.921424);">into this higher level IR, one-to-one permutations are automatically</span><span dir="ltr" style="left: 514.959px; top: 374.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.919718);">performed.  That  is  because  both  gadgets  and  instructions  are</span><span dir="ltr" style="left: 514.966px; top: 391.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.935293);">classified into one of these types, based on which the encoding is</span><span dir="ltr" style="left: 514.955px; top: 408.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.961168);">then performed, rather than on the instructions per se. The IR is</span><span dir="ltr" style="left: 514.962px; top: 424.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.926724);">also useful for selecting the encoder function accompanying every</span><span dir="ltr" style="left: 514.965px; top: 441.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.899084);">gadget. Encoders are responsible to answer ‘whether their assigned</span><span dir="ltr" style="left: 514.965px; top: 458.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.922969);">gadget can encode a given instruction’, as well as to encode it into</span><span dir="ltr" style="left: 514.958px; top: 474.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.904855);">a list of stack operations if requested to.</span><span dir="ltr" style="left: 534.954px; top: 491.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.917586);">Predefined, one-to-one permutations (i.e. one instruction to one</span><span dir="ltr" style="left: 514.966px; top: 508.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.946264);">gadget)  are  achieved  through  the  IR  and  encoder  functions.</span><span dir="ltr" style="left: 514.959px; top: 524.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.930146);">Encoders will also perform basic algebraic permutations based on</span><span dir="ltr" style="left: 514.957px; top: 541.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.937419);">the properties of addition, subtraction, multiplication, and division.</span><span dir="ltr" style="left: 514.955px; top: 558.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.938912);">For instance, if the instruction to be encoded is of type ADD_IMM</span><span dir="ltr" style="left: 514.962px; top: 574.983px; font-size: 15px; font-family: sans-serif;">(</span><span dir="ltr" style="left: 519.957px; top: 574.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.933579);">add reg, imm</span><span dir="ltr" style="left: 601.69px; top: 574.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.942324);">), an encoder will repeat anything </span><span dir="ltr" style="left: 815.163px; top: 574.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.937694);">add reg, x</span><span dir="ltr" style="left: 877.727px; top: 574.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.01465);"> with </span><span dir="ltr" style="left: 914.594px; top: 574.983px; font-size: 15px; font-family: sans-serif;">x</span><span dir="ltr" style="left: 514.964px; top: 591.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.961093);">being  an  integer  divisor  of </span><span dir="ltr" style="left: 705.759px; top: 591.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.937315);">imm,  imm/x</span><span dir="ltr" style="left: 781.503px; top: 591.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.96919);">  times.  Addition  and</span><span dir="ltr" style="left: 514.961px; top: 608.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.940713);">subtraction with constants will also be swapped if the signs of the</span><span dir="ltr" style="left: 514.961px; top: 624.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.942137);">constants  are  flipped. </span><span dir="ltr" style="left: 668.256px; top: 624.983px; font-size: 15px; font-family: sans-serif;">M</span><span dir="ltr" style="left: 680.751px; top: 624.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.962779);">-to-</span><span dir="ltr" style="left: 702.396px; top: 624.983px; font-size: 15px; font-family: sans-serif;">N</span><span dir="ltr" style="left: 712.401px; top: 624.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.978941);">  permutations  quickly  scale  to</span><span dir="ltr" style="left: 514.957px; top: 641.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.910012);">exponentially growing space and are out of the scope of this work.</span><span dir="ltr" style="left: 534.953px; top: 658.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.915797);">In order to enhance transformation of the source shellcode, and</span><span dir="ltr" style="left: 514.961px; top: 674.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.928387);">since not all required gadgets are always found in the PE file, new</span><span dir="ltr" style="left: 514.958px; top: 691.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.898082);">ones  are  also  injected  as  needed.  Firstly,  the  0xCC  caves  (i.e.</span><span dir="ltr" style="left: 514.95px; top: 708.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.935544);">padding commonly left by the linker in-between code segments in</span><span dir="ltr" style="left: 514.955px; top: 724.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.948094);">the text section of PEs) are used for this injection, and if they are</span><span dir="ltr" style="left: 514.956px; top: 741.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.895932);">filled,  the  text  section  is  extended  before  the  actual  patch.  The</span><span dir="ltr" style="left: 514.961px; top: 758.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.939108);">injection is performed in the least noticeable way to avoid alarms.</span><span dir="ltr" style="left: 514.963px; top: 774.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.946338);">If a standard epilogue (</span><span dir="ltr" style="left: 660.146px; top: 774.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.93569);">mov esp, ebp; pop ebp; ret</span><span dir="ltr" style="left: 827.127px; top: 774.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.990359);">) is found right</span><span dir="ltr" style="left: 514.957px; top: 791.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.933574);">before  the  0xCC  cave,  the  gadget  is  injected  in-between  the</span><span dir="ltr" style="left: 514.963px; top: 808.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.939003);">preceding code and the epilogue. Fig. 2 depicts such an example</span><span dir="ltr" style="left: 514.965px; top: 824.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.909272);">gadget  injection  of  a </span><span dir="ltr" style="left: 655.677px; top: 824.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.869692);">mov  ecx,  eax</span><span dir="ltr" style="left: 739.751px; top: 824.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.877883);">  gadget.  In  the  case  that  no</span><span dir="ltr" style="left: 514.958px; top: 841.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.944305);">epilogue is found at the boundary with the 0xCC cave, a pseudo-</span><span dir="ltr" style="left: 514.96px; top: 858.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.95362);">function with standard prologue and epilogue is injected to avoid</span><span dir="ltr" style="left: 514.961px; top: 874.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.931252);">heuristics  or </span><span dir="ltr" style="left: 603.573px; top: 874.983px; font-size: 15px; font-family: sans-serif;">n</span><span dir="ltr" style="left: 611.073px; top: 874.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.94199);">-grams  that  might  raise  suspicion  due  to  non-</span><span dir="ltr" style="left: 514.961px; top: 891.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.941005);">ordinary  returns.  This  pseudo-function  has  the  following  form</span><span dir="ltr" style="left: 514.954px; top: 908.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.923311);">shown in Fig. 3. </span><span dir="ltr" style="left: 534.964px; top: 924.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.919369);">Algorithm  1  as  shown  in  Fig.  4  is  used  when  ROPInjector</span><span dir="ltr" style="left: 514.953px; top: 941.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.963374);">builds the ROP equivalent of a given shellcode. The first step of</span><span dir="ltr" style="left: 514.96px; top: 958.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.933603);">the algorithm is to scan the PE and find all the pieces of code that</span><span dir="ltr" style="left: 514.957px; top: 974.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.963056);">could potentially be used for chaining to the provided shellcode,</span><span dir="ltr" style="left: 514.961px; top: 991.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.912576);">named  gadget  endings.  As  a  last  step  of  the  initialisation,  the</span><span dir="ltr" style="left: 514.964px; top: 1008.32px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.892831);">algorithm  locates  the  0xCC  nests  (also  known  as  caves)  where</span><span dir="ltr" style="left: 514.96px; top: 1024.98px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.95951);">gadgets can be generated and injected if not found in the PE. In</span><span dir="ltr" style="left: 514.962px; top: 1041.65px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.965087);">case one or more suitable gadgets are found for the instruction,</span><span dir="ltr" style="left: 514.955px; top: 1058.32px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.897337);">then  the  best  one  is  chosen.  In  this  scope,  the  best  gadget  is</span><span dir="ltr" style="left: 70.8658px; top: 1276.36px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.02759);">Fig. 2௒</span><span dir="ltr" style="left: 113.466px; top: 1276.36px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.918995);">Injection of gadget (right) in 0xCC cave preceded by standard function epilogue (left)</span><span dir="ltr" style="left: 70.8662px; top: 1320.58px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999841);">572</span><span dir="ltr" style="left: 637.133px; top: 1320.58px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00354);">IET Inf. Secur.</span><span dir="ltr" style="left: 721.853px; top: 1320.58px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00037);">, 2019, Vol. 13 Iss. 6, pp. 570-578</span><span dir="ltr" style="left: 603.812px; top: 1338.92px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00018);">© The Institution of Engineering and Technology 2019</span><div class="endOfContent"></div></div><div class="annotationLayer"><section data-annotation-id="20R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -453.545px -485.3px; left: 453.545px; top: 485.3px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A19%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C192.122%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="21R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -360.485px -545.3px; left: 360.485px; top: 545.3px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A27%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C792.59%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="22R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -442.554px -555.3px; left: 442.554px; top: 555.3px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A27%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C666.968%2Cnull%5D" class="internalLink"></a></section></div></div><div class="page" data-page-number="4" role="region" style="width: 992px; height: 1403px;" data-loaded="true"><div class="canvasWrapper" style="width: 992px; height: 1403px;"><canvas width="993" height="1404" style="width: 993px; height: 1404px;"></canvas></div><div class="textLayer" style="width: 992px; height: 1403px;"><span dir="ltr" style="left: 70.8658px; top: 1028.96px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.950252);">considered to be the one that contains less instructions. Next, all</span><span dir="ltr" style="left: 70.8658px; top: 1045.63px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.93271);">instructions are checked against the list of candidate gadgets. We</span><span dir="ltr" style="left: 70.8626px; top: 1062.29px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.924865);">have to distinguish one important case here: in case an instruction</span><span dir="ltr" style="left: 70.8691px; top: 1078.96px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.970766);">cannot be encoded by any of the gadgets found in the previous</span><span dir="ltr" style="left: 70.871px; top: 1095.63px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.889264);">step, then a suitable gadget needs to be generated and injected (see</span><span dir="ltr" style="left: 70.8691px; top: 1112.29px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.912734);">line  10  of  Algorithm  1).  For  this  purpose,  the  0xCC  nests  are</span><span dir="ltr" style="left: 70.8723px; top: 1128.96px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.907504);">considered as presented in Algorithm 2 (see Fig. 5). That is, if there</span><span dir="ltr" style="left: 70.8723px; top: 1145.63px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.944565);">is space, then the needed gadget is injected in the caves. On the</span><span dir="ltr" style="left: 70.8632px; top: 1162.29px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.932029);">other hand, if the gadget cannot fit, then the text section of the PE</span><span dir="ltr" style="left: 70.8593px; top: 1178.96px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.878006);">is extended to create more space. </span><span dir="ltr" style="left: 90.8698px; top: 1195.63px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.987947);">Continuing now with Algorithm 1, gadgets either injected or</span><span dir="ltr" style="left: 70.8627px; top: 1212.29px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.951759);">found, are used to encode each one of the (allowed) instructions</span><span dir="ltr" style="left: 70.8685px; top: 1228.96px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.917964);">contained in the shellcode. The last step of this algorithm concerns</span><span dir="ltr" style="left: 70.8627px; top: 1245.63px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.933669);">the chaining of the gadgets (either found or injected). For this part</span><span dir="ltr" style="left: 70.864px; top: 1262.29px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.900265);">we have to distinguish two cases:</span><span dir="ltr" style="left: 514.959px; top: 81.6489px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.967071);">i.  If  a  gadget  is  targeted  by  a  branch  instruction,  then  the</span><span dir="ltr" style="left: 539.967px; top: 98.3156px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.918668);">algorithm handles it as a new chain where more gadget chains</span><span dir="ltr" style="left: 539.955px; top: 114.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.86305);">can be added.</span><span dir="ltr" style="left: 514.965px; top: 133.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.00064);">ii. If the gadget is not targeted, the algorithm just adds it to an</span><span dir="ltr" style="left: 539.966px; top: 149.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.904594);">existing gadget chain.</span><span dir="ltr" style="left: 514.961px; top: 186.715px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.999649);">3.5 Chaining gadgets</span><span dir="ltr" style="left: 514.961px; top: 213.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.905875);">The  return  address  chain  can  be  built  either  during  runtime  or</span><span dir="ltr" style="left: 514.962px; top: 229.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.9268);">during compile-time and saved to the initialised data section of the</span><span dir="ltr" style="left: 514.969px; top: 246.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.939394);">file (to be then copied at runtime to the stack). The most alarming</span><span dir="ltr" style="left: 514.958px; top: 263.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.972766);">option would be the first (during runtime) and we choose this to</span><span dir="ltr" style="left: 514.958px; top: 279.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.902653);">evaluate our evasion ratio. During this process, besides the pushing</span><span dir="ltr" style="left: 514.958px; top: 296.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.909952);">of the VAs onto the stack, the ROP compiler must consider pushing</span><span dir="ltr" style="left: 514.964px; top: 313.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.912837);">immediate constants, adjustments for stack pointer modifications in</span><span dir="ltr" style="left: 514.962px; top: 329.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.877583);">the  gadget  (e.g.  redundant </span><span dir="ltr" style="left: 688px; top: 329.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.874636);">pops,  retns</span><span dir="ltr" style="left: 756.553px; top: 329.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.889904);">)  and  gadgets  with  loader</span><span dir="ltr" style="left: 514.962px; top: 346.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.943843);">gadgets. For this purpose, the following types of </span><span dir="ltr" style="left: 821.033px; top: 346.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.917703);">stack operations</span><span dir="ltr" style="left: 514.965px; top: 363.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.899125);">are defined:</span><span dir="ltr" style="left: 514.965px; top: 396.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.91097);">PUSH_VA; push a (loader) gadget VA onto the stack</span><span dir="ltr" style="left: 514.965px; top: 414.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.911233);">PUSH_IMM; push an immediate constant onto the stack</span><span dir="ltr" style="left: 514.965px; top: 433.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.930741);">ADVANCE; advance (subtract from) the stack pointer a number of</span><span dir="ltr" style="left: 514.962px; top: 449.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.88328);">bytes</span><span dir="ltr" style="left: 514.962px; top: 468.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.931839);">CHAIN;  pseudo-operation  denoting  a  placeholder  for  the  next</span><span dir="ltr" style="left: 514.964px; top: 484.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.907833);">gadget's VA</span><span dir="ltr" style="left: 514.964px; top: 518.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.914216);">The result of the encoding process of a given instruction by a given</span><span dir="ltr" style="left: 514.958px; top: 534.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.895832);">gadget  is  a  series  of  stack  operations  for  the  invocation  of  the</span><span dir="ltr" style="left: 514.967px; top: 551.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.907747);">gadget. The list of such operations for all gadget calls describes the</span><span dir="ltr" style="left: 514.955px; top: 568.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.967285);">assembly instructions that if executed, will build the chain in the</span><span dir="ltr" style="left: 514.968px; top: 584.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.896553);">stack.  Alternatively,  such  operations  may  be  used  to  create  the</span><span dir="ltr" style="left: 514.955px; top: 601.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.918169);">required stack frame during compile-time, save it as initialised data</span><span dir="ltr" style="left: 514.964px; top: 618.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.963438);">and copy it over from the data section during runtime. The latter</span><span dir="ltr" style="left: 514.96px; top: 634.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.953679);">process allows also for encoding/decoding of the stack frame. In</span><span dir="ltr" style="left: 514.961px; top: 651.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.973101);">the former case, and when multiple calls are made to the same</span><span dir="ltr" style="left: 514.957px; top: 668.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.899746);">gadget (e.g. as in using </span><span dir="ltr" style="left: 659.499px; top: 668.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.902844);">inc eax</span><span dir="ltr" style="left: 702.879px; top: 668.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.909011);"> to achieve </span><span dir="ltr" style="left: 773.08px; top: 668.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.900194);">add eax, 3</span><span dir="ltr" style="left: 836.141px; top: 668.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.937184);">) the compiler</span><span dir="ltr" style="left: 514.962px; top: 684.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.918165);">wraps the call with a conditional jump loop using a free register.</span><span dir="ltr" style="left: 534.957px; top: 701.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.973556);">However, not all types of instructions can be easily encoded</span><span dir="ltr" style="left: 514.962px; top: 718.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.945148);">into  ROP.  In  this  work,  we  do  not  consider  the  encoding  of</span><span dir="ltr" style="left: 514.958px; top: 734.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.954007);">branches (jumps, calls, loops, interrupts), privileged instructions,</span><span dir="ltr" style="left: 514.963px; top: 751.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.911104);">and  pops.  Hence,  the  return-oriented  code  chunks  must  finally</span><span dir="ltr" style="left: 514.967px; top: 768.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.935504);">return back to the source shellcode. This is achieved by wrapping</span><span dir="ltr" style="left: 514.96px; top: 784.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.939318);">the chain building instructions in the following:</span><span dir="ltr" style="left: 514.96px; top: 818.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.01896);">[1] </span><span dir="ltr" style="left: 536.201px; top: 818.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.954848);">call build_chain</span><span dir="ltr" style="left: 514.96px; top: 836.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.01896);">[2] </span><span dir="ltr" style="left: 536.201px; top: 836.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.906517);">jmp past_the_chain</span><span dir="ltr" style="left: 514.96px; top: 854.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.01896);">[3] </span><span dir="ltr" style="left: 536.201px; top: 854.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.957705);">build_chain:</span><span dir="ltr" style="left: 514.96px; top: 873.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.01896);">[4] </span><span dir="ltr" style="left: 536.201px; top: 873.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.871053);">push</span><span dir="rtl" style="left: 568.285px; top: 873.588px; font-size: 15px; font-family: monospace;">ࠑ</span><span dir="ltr" style="left: 583.285px; top: 873.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.904261);">VA of gadget N</span><span dir="rtl" style="left: 674.246px; top: 873.588px; font-size: 15px; font-family: monospace;">ࠒ</span><span dir="ltr" style="left: 514.96px; top: 891.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.01896);">[5] </span><span dir="ltr" style="left: 536.201px; top: 891.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.899824);">....</span><span dir="ltr" style="left: 514.96px; top: 909.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.01896);">[6] </span><span dir="ltr" style="left: 536.201px; top: 909.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.871053);">push</span><span dir="rtl" style="left: 568.285px; top: 910.255px; font-size: 15px; font-family: monospace;">ࠑ</span><span dir="ltr" style="left: 583.285px; top: 909.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.901681);">VA of gadget 1</span><span dir="rtl" style="left: 671.74px; top: 910.255px; font-size: 15px; font-family: monospace;">ࠒ</span><span dir="ltr" style="left: 514.96px; top: 928.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.01896);">[7] </span><span dir="ltr" style="left: 536.2px; top: 928.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.920449);">ret</span><span dir="ltr" style="left: 514.96px; top: 946.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.01896);">[8] </span><span dir="ltr" style="left: 536.2px; top: 946.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.912706);">past_the_chain:</span><span dir="ltr" style="left: 514.96px; top: 964.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.01896);">[9] </span><span dir="rtl" style="left: 536.2px; top: 965.255px; font-size: 15px; font-family: monospace;">ࠑ</span><span dir="ltr" style="left: 551.2px; top: 964.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.924941);">other instructions/chains</span><span dir="rtl" style="left: 700.78px; top: 965.255px; font-size: 15px; font-family: monospace;">ࠒ</span><span dir="ltr" style="left: 514.96px; top: 998.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.91444);">In  this  way,  the  last  gadget  (</span><span dir="ltr" style="left: 707.537px; top: 998.316px; font-size: 15px; font-family: sans-serif;">N</span><span dir="ltr" style="left: 717.542px; top: 998.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.9584);">)  will  return  to  instruction  [12]</span><span dir="ltr" style="left: 514.964px; top: 1014.98px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.928325);">jumping past the chain building instructions and continuing normal</span><span dir="ltr" style="left: 514.955px; top: 1031.65px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.938747);">execution flow.</span><span dir="ltr" style="left: 514.955px; top: 1068.38px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.999789);">3.6 PE patching and passing control to the shellcode</span><span dir="ltr" style="left: 514.955px; top: 1094.98px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.929947);">First of all, the patching of the PE file and the passing of control to</span><span dir="ltr" style="left: 514.955px; top: 1111.65px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.937712);">the shellcode must be done in the least noticeable way. A second</span><span dir="ltr" style="left: 514.955px; top: 1128.32px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.957594);">executable section hosting the shellcode would be too alarming,</span><span dir="ltr" style="left: 514.961px; top: 1144.98px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.921374);">since the vast majority of executables has only one. The next least</span><span dir="ltr" style="left: 514.956px; top: 1161.65px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.992628);">disruptive and easy to implement option would be to inject the</span><span dir="ltr" style="left: 514.963px; top: 1178.32px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.944535);">shellcode once again in the 0xCC nests. However, there may not</span><span dir="ltr" style="left: 514.955px; top: 1194.98px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.954496);">always be sufficient space in those 0xCC caves, as ROPInjector</span><span dir="ltr" style="left: 514.968px; top: 1211.65px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.896884);">puts this padding space to inject the required missing gadgets.</span><span dir="ltr" style="left: 534.963px; top: 1228.32px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.887771);">For the above reasons, we choose to append the shellcode to the</span><span dir="ltr" style="left: 514.965px; top: 1244.98px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.921553);">existing  text  section  of  the  executable,  and  correct  all  section</span><span dir="ltr" style="left: 514.968px; top: 1261.65px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.916782);">headers  and  relocations  accordingly.  To  pass  control  to  it,  the</span><span dir="ltr" style="left: 514.963px; top: 1278.32px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.96897);">default  practice  is  to  replace  the  instructions  pointed  to  by</span><span dir="ltr" style="left: 70.8658px; top: 258.578px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.02759);">Fig. 3௒</span><span dir="ltr" style="left: 113.466px; top: 258.578px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.912633);">Pseudo-function ending used during gadget injection</span><span dir="ltr" style="left: 70.8658px; top: 697.148px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.02759);">Fig. 4௒</span><span dir="ltr" style="left: 113.466px; top: 697.148px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.939361);">ROP compilation algorithm</span><span dir="ltr" style="left: 70.8658px; top: 996.518px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.02759);">Fig. 5௒</span><span dir="ltr" style="left: 113.466px; top: 996.518px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.937756);">Gadget injection algorithm</span><span dir="ltr" style="left: 70.8628px; top: 1320.58px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00354);">IET Inf. Secur.</span><span dir="ltr" style="left: 155.583px; top: 1320.58px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00037);">, 2019, Vol. 13 Iss. 6, pp. 570-578</span><span dir="ltr" style="left: 70.8628px; top: 1338.92px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00018);">© The Institution of Engineering and Technology 2019</span><span dir="ltr" style="left: 899.009px; top: 1320.58px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999841);">573</span><div class="endOfContent"></div></div><div class="annotationLayer"><section data-annotation-id="28R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -219.291px -677.686px; left: 219.291px; top: 677.686px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A27%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C403.826%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="29R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -540.759px -599.3px; left: 540.759px; top: 599.3px; width: 9px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A80%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C681.09%2Cnull%5D" class="internalLink"></a></section></div></div><div class="page" data-page-number="5" role="region" style="width: 992px; height: 1403px;" data-loaded="true"><div class="canvasWrapper" style="width: 992px; height: 1403px;"><canvas width="993" height="1404" style="width: 993px; height: 1404px;"></canvas></div><div class="textLayer" style="width: 992px; height: 1403px;"><span dir="ltr" style="left: 70.8658px; top: 81.6489px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.948287);">NT_HEADER.AddressOfEntryPoint with a jump to the shellcode,</span><span dir="ltr" style="left: 70.8691px; top: 98.3156px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.89752);">which  is  appended  to  those  replaced  instructions  followed  by  a</span><span dir="ltr" style="left: 70.8736px; top: 114.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.92659);">jump  back  to  the  original  execution  flow.  Directly  pointing  the</span><span dir="ltr" style="left: 70.8671px; top: 131.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.907628);">address of entry point to the shellcode in this case is avoided, since</span><span dir="ltr" style="left: 70.8639px; top: 148.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.929094);">many AVs’ heuristics are alarmed by the fact that it points towards</span><span dir="ltr" style="left: 70.8587px; top: 164.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.916305);">the  end  of  text  section.  An  alternative  to  giving  control  to  the</span><span dir="ltr" style="left: 70.8684px; top: 181.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.923328);">shellcode at program entry is to hook any calls to ExitProcess, exit</span><span dir="ltr" style="left: 70.8684px; top: 198.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.963225);">or other similar functions. This technique in particular, as shown</span><span dir="ltr" style="left: 70.8639px; top: 214.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.915065);">also later by the results, bypasses behavioural profiling by AVs that</span><span dir="ltr" style="left: 70.8619px; top: 231.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.926503);">employ emulation or sandboxing. This can be attributed to the fact</span><span dir="ltr" style="left: 70.8736px; top: 248.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.974818);">that either AVs emulate only a small portion of the executable's</span><span dir="ltr" style="left: 70.8639px; top: 264.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.906132);">entry code due to scanning time constraints, or because of a lack of</span><span dir="ltr" style="left: 70.8639px; top: 281.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.91966);">techniques for triggering a graceful exit (i.e. many programs do not</span><span dir="ltr" style="left: 70.8639px; top: 298.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.927671);">handle SIGINT and SIGTERM signals).</span><span dir="ltr" style="left: 70.8691px; top: 335.831px; font-size: 16.6667px; font-family: sans-serif; transform: scaleX(1.13138);">4௑Experiments and results</span><span dir="ltr" style="left: 70.8606px; top: 361.715px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.999719);">4.1 Methodology</span><span dir="ltr" style="left: 70.8606px; top: 388.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.957415);">In this section, we present the methodology adopted to evaluate</span><span dir="ltr" style="left: 70.8626px; top: 404.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.975559);">ROPInejctor. We have selected for carrier PEs 9 popular 32-bit</span><span dir="ltr" style="left: 70.8723px; top: 421.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.96703);">executables (see first column of Table 1). Regarding the source</span><span dir="ltr" style="left: 70.8678px; top: 438.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.946393);">shellcode,  we  selected  two  of  the  most  popular  payloads  of</span><span dir="ltr" style="left: 70.8697px; top: 454.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.911169);">Metasploit  framework  [13]:  (i)  (staged)  meterpreter  reverse  tcp,</span><span dir="ltr" style="left: 70.8678px; top: 471.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.939042);">and (ii) the reverse tcp shell. For each PE (nine in total) and each</span><span dir="ltr" style="left: 70.858px; top: 488.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.957439);">shellcode (two in total) we performed four patching scenarios as</span><span dir="ltr" style="left: 70.8645px; top: 504.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.989384);">analysed in Table 2: (i) ROP entry, (ii) ROP exit, (iii) Shellcode</span><span dir="ltr" style="left: 70.858px; top: 521.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.964612);">entry, (iv) Shellcode exit. Thus, we created 72 different samples</span><span dir="ltr" style="left: 70.8717px; top: 538.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.939149);">(i.e. 72 infected PEs). On these samples we derived the following</span><span dir="ltr" style="left: 70.8587px; top: 554.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.896434);">results:</span><span dir="ltr" style="left: 70.8587px; top: 588.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.989451);">i.  Various statistics including: (i) number of candidate gadgets</span><span dir="ltr" style="left: 95.8632px; top: 604.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.920252);">found in the PEs, (ii) number of gadgets re-used from the PEs,</span><span dir="ltr" style="left: 95.858px; top: 621.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.98186);">(iii)  missing  gadgets  that  were  injected,  (iv)  number  of</span><span dir="ltr" style="left: 95.8729px; top: 638.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.918433);">instructions of the two tested shellcodes that were transformed</span><span dir="ltr" style="left: 95.8697px; top: 654.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.902749);">to ROP equivalents.</span><span dir="ltr" style="left: 70.8645px; top: 673.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.933858);">ii. Similarity measurements between original PE and infected PE.</span><span dir="ltr" style="left: 70.8645px; top: 691.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.953819);">iii. ROPInjector Code complexity metrics.</span><span dir="ltr" style="left: 70.8645px; top: 709.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.968408);">iv. Evasion results for each PE and top 10 popular AV detection</span><span dir="ltr" style="left: 95.8703px; top: 726.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.887695);">results.</span><span dir="ltr" style="left: 70.8652px; top: 744.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.947147);">v. Evasion  results  for  Enhanced  Mitigation  Experience  Toolkit</span><span dir="ltr" style="left: 95.8593px; top: 761.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.977602);">(EMET).</span><span dir="ltr" style="left: 90.8645px; top: 794.982px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.930503);">Note  that  all  conducted  experiments  were  performed  on  a</span><span dir="ltr" style="left: 70.8625px; top: 811.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.914636);">Windows 7 32-bit operating system.</span><span dir="ltr" style="left: 514.958px; top: 81.7156px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.999859);">4.2 Statistics and similarity measurements</span><span dir="ltr" style="left: 514.958px; top: 108.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.92656);">Statistics and information regarding the infected PE are generated</span><span dir="ltr" style="left: 514.956px; top: 124.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.970824);">for each execution of ROPInjector using the method ROP entry</span><span dir="ltr" style="left: 514.956px; top: 141.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.887475);">and as shellcode the reverse tcp shell (see Table 1). As expected the</span><span dir="ltr" style="left: 514.956px; top: 158.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.899268);">largest executable (i.e. notepad++.exe) includes the highest number</span><span dir="ltr" style="left: 514.953px; top: 174.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.948185);">of candidate gadgets (i.e. 7778). However, only 41 gadgets were</span><span dir="ltr" style="left: 514.965px; top: 191.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.907556);">used, while 55 were generated and injected by ROPInjector. On the</span><span dir="ltr" style="left: 514.958px; top: 208.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.895954);">opposite  side,  in  the  smallest  executable  named  Rainmeter.exe,</span><span dir="ltr" style="left: 514.962px; top: 224.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.923016);">ROPInjector discovered only 11 candidate candidates and none of</span><span dir="ltr" style="left: 514.958px; top: 241.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.92646);">them were eventually used to build the ROP chain (i.e. all gadgets</span><span dir="ltr" style="left: 514.962px; top: 258.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.94474);">for Rainmeter.exe were generated and injected by ROPInjector –</span><span dir="ltr" style="left: 514.952px; top: 274.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.937856);">83 in total).</span><span dir="ltr" style="left: 534.963px; top: 291.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.944611);">We also derived statistics for the shellcodes that we tested. In</span><span dir="ltr" style="left: 514.963px; top: 308.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.959617);">particular, we examined how many instructions of the shellcode,</span><span dir="ltr" style="left: 514.963px; top: 324.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.919709);">ROPInjector  actually  transformed  them  to  ROP  equivalents.  In</span><span dir="ltr" style="left: 514.955px; top: 341.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.946458);">particular, the reverse tcp shell consists of 193 instructions out of</span><span dir="ltr" style="left: 514.963px; top: 358.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.933736);">which  139  were  replaced  with  gadgets  by  ROPInjector,  while</span><span dir="ltr" style="left: 514.96px; top: 374.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.919565);">(staged) meterpreter reverse tcp includes 187 instructions and 129</span><span dir="ltr" style="left: 514.956px; top: 391.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.907436);">were transformed eventually to ROP equivalents.</span><span dir="ltr" style="left: 534.966px; top: 408.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.959543);">In the next experiment, we derived the similarity between the</span><span dir="ltr" style="left: 514.962px; top: 424.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.930164);">benign PE and the infected PE. The aim of this experiment was to</span><span dir="ltr" style="left: 514.964px; top: 441.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.937374);">measure quantitatively the modifications that ROPInjector causes</span><span dir="ltr" style="left: 514.961px; top: 458.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.934298);">to the original PE. We used as a metric the cosine similarity, sinc</span><span dir="ltr" style="left: 914.738px; top: 458.316px; font-size: 15px; font-family: sans-serif;">e</span><span dir="ltr" style="left: 514.959px; top: 474.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.917928);">it  has  been  used  by  previous  works  to  detect  obfuscations  of</span><span dir="ltr" style="left: 514.964px; top: 491.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.964544);">malware variants [14]. We tested three different PEs taken from</span><span dir="ltr" style="left: 514.967px; top: 508.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.894417);">Table  1  and  as  a  shellcode  we  selected  reverse  tcp  shell.  The</span><span dir="ltr" style="left: 514.967px; top: 524.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.974643);">direction we followed was to analyse the text section of the two</span><span dir="ltr" style="left: 514.963px; top: 541.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.961316);">PEs and compare them as strings. Table 3 shows the numerical</span><span dir="ltr" style="left: 514.963px; top: 558.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.9129);">results of our experiments (in our case cosine similarity takes value</span><span dir="ltr" style="left: 514.965px; top: 574.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.926554);">from 0 to 1, where 1 means exact matching). As shown in Table 3,</span><span dir="ltr" style="left: 514.961px; top: 591.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.930302);">in all methods of ROP transformation (ROP entry or ROP exit) the</span><span dir="ltr" style="left: 514.955px; top: 608.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.00138);">similarity was very high (</span><span dir="ltr" style="left: 678.541px; top: 608.316px; font-size: 15px; font-family: sans-serif;">∼</span><span dir="ltr" style="left: 688.817px; top: 608.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.978214);">0.99 in all cases), while for patching</span><span dir="ltr" style="left: 514.962px; top: 624.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.984633);">methods  without  ROP  transformation  (Shellcode  entry  and</span><span dir="ltr" style="left: 514.959px; top: 641.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.968971);">Shellcode exit) the similarity was even equal to 1 (for java.exe).</span><span dir="ltr" style="left: 514.953px; top: 658.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.940902);">This outcome is a direct result of ROPInjector approach to re-use</span><span dir="ltr" style="left: 514.962px; top: 674.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.978676);">code  found  in  the  carrier  PE  introducing  only  some  minor</span><span dir="ltr" style="left: 514.966px; top: 691.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.919846);">modifications  to  the  PE.  In  essence,  the  main  modification  by</span><span dir="ltr" style="left: 514.956px; top: 708.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.919684);">ROPInjector  occurs  when  it  resorts  to  the  injection  of  missing</span><span dir="ltr" style="left: 514.956px; top: 724.983px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.89587);">gadgets  in  the  code  caves,  only  when  the  carrier  PE  does  not</span><span dir="ltr" style="left: 514.96px; top: 741.649px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.930031);">provide the appropriate gadgets for the ROP transformation of the</span><span dir="ltr" style="left: 514.966px; top: 758.316px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.89476);">shellcode. </span><span dir="ltr" style="left: 70.8714px; top: 866.233px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.04545);">Table 1</span><span dir="ltr" style="left: 136.436px; top: 866.233px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.999883);">List of PE files used as carriers in the experiments and various stati</span><span dir="ltr" style="left: 582.441px; top: 866.233px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.999908);">stics (ROP entry method and reverse tcp shell)</span><span dir="ltr" style="left: 72.1226px; top: 885.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.00001);">PE</span><span dir="ltr" style="left: 180.429px; top: 885.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.14811);">Size, kB   File version</span><span dir="ltr" style="left: 390.572px; top: 885.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.05862);">Candidate gadgets found in PE  Gadgets in</span><span dir="ltr" style="left: 696.061px; top: 885.049px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.0651);">jected  Gadgets used from PE</span><span dir="ltr" style="left: 72.1142px; top: 905.933px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00026);">Acrobat.exe</span><span dir="ltr" style="left: 196.809px; top: 905.933px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.13521);">650   19.10.20069.49826</span><span dir="ltr" style="left: 483.253px; top: 905.933px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999933);">338</span><span dir="ltr" style="left: 672.353px; top: 905.933px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999978);">78</span><span dir="ltr" style="left: 825.878px; top: 905.933px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999841);">12</span><span dir="ltr" style="left: 72.1142px; top: 925.1px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.16837);">AcroRd32.exe    1423</span><span dir="ltr" style="left: 284.052px; top: 925.1px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.979801);">11.0.8.4</span><span dir="ltr" style="left: 479.555px; top: 925.1px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.99991);">5599</span><span dir="ltr" style="left: 672.36px; top: 925.1px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999978);">67</span><span dir="ltr" style="left: 825.884px; top: 925.1px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999841);">26</span><span dir="ltr" style="left: 72.1142px; top: 944.266px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00028);">cmd.exe</span><span dir="ltr" style="left: 196.811px; top: 944.266px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999933);">305</span><span dir="ltr" style="left: 261.316px; top: 944.266px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00007);">6.3.9600.16384</span><span dir="ltr" style="left: 483.261px; top: 944.266px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999933);">608</span><span dir="ltr" style="left: 672.361px; top: 944.266px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999978);">76</span><span dir="ltr" style="left: 825.886px; top: 944.266px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999841);">16</span><span dir="ltr" style="left: 72.1142px; top: 963.433px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.0003);">firefox.exe</span><span dir="ltr" style="left: 196.811px; top: 963.433px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999933);">439</span><span dir="ltr" style="left: 272.437px; top: 963.433px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00015);">63.0.3.6892</span><span dir="ltr" style="left: 479.561px; top: 963.433px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.99991);">1634</span><span dir="ltr" style="left: 672.366px; top: 963.433px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999978);">65</span><span dir="ltr" style="left: 825.89px; top: 963.433px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999841);">28</span><span dir="ltr" style="left: 72.1142px; top: 982.6px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.0001);">java.exe</span><span dir="ltr" style="left: 196.806px; top: 982.6px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999933);">187</span><span dir="ltr" style="left: 276.138px; top: 982.6px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00018);">8.0.192.12</span><span dir="ltr" style="left: 480.051px; top: 982.6px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.966625);">1148</span><span dir="ltr" style="left: 672.362px; top: 982.6px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999978);">76</span><span dir="ltr" style="left: 825.887px; top: 982.6px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999841);">18</span><span dir="ltr" style="left: 72.1142px; top: 1001.77px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.0002);">nam.exe</span><span dir="ltr" style="left: 193.102px; top: 1001.77px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.99991);">1828</span><span dir="ltr" style="left: 284.058px; top: 1001.77px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.979264);">1.0a11a</span><span dir="ltr" style="left: 479.556px; top: 1001.77px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.99991);">3515</span><span dir="ltr" style="left: 672.36px; top: 1001.77px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999978);">67</span><span dir="ltr" style="left: 825.885px; top: 1001.77px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999841);">25</span><span dir="ltr" style="left: 72.1142px; top: 1020.93px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.16141);">notepad++.exe   2783</span><span dir="ltr" style="left: 287.266px; top: 1020.93px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00037);">7.6.0.0</span><span dir="ltr" style="left: 479.559px; top: 1020.93px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.99991);">7778</span><span dir="ltr" style="left: 672.364px; top: 1020.93px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999978);">55</span><span dir="ltr" style="left: 825.888px; top: 1020.93px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999841);">41</span><span dir="ltr" style="left: 72.1142px; top: 1040.1px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00015);">Rainmeter.exe</span><span dir="ltr" style="left: 200.508px; top: 1040.1px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999978);">39</span><span dir="ltr" style="left: 276.136px; top: 1040.1px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00018);">2.4.0.1678</span><span dir="ltr" style="left: 487.462px; top: 1040.1px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.933408);">11</span><span dir="ltr" style="left: 672.364px; top: 1040.1px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999978);">83</span><span dir="ltr" style="left: 829.595px; top: 1040.1px; font-size: 13.3333px; font-family: sans-serif;">0</span><span dir="ltr" style="left: 72.1142px; top: 1059.27px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00013);">wmplayer.exe</span><span dir="ltr" style="left: 196.802px; top: 1059.27px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999933);">163</span><span dir="ltr" style="left: 257.6px; top: 1059.27px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00006);">12.0.9600.19145</span><span dir="ltr" style="left: 486.956px; top: 1059.27px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999978);">60</span><span dir="ltr" style="left: 672.352px; top: 1059.27px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999978);">82</span><span dir="ltr" style="left: 829.583px; top: 1059.27px; font-size: 13.3333px; font-family: sans-serif;">3</span><span dir="ltr" style="left: 70.8697px; top: 1110.47px; font-size: 15px; font-family: sans-serif; transform: scaleX(1.04576);">Table 2</span><span dir="ltr" style="left: 136.434px; top: 1110.47px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.999886);">List of patching methods tested</span><span dir="ltr" style="left: 72.1197px; top: 1129.28px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.999867);">Patch method</span><span dir="ltr" style="left: 550.09px; top: 1129.28px; font-size: 15px; font-family: sans-serif; transform: scaleX(0.999621);">Description</span><span dir="ltr" style="left: 72.1131px; top: 1150.17px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.0004);">ROP entry</span><span dir="ltr" style="left: 275.559px; top: 1150.17px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00016);">the executable file is patched with the shellcode </span><span dir="ltr" style="left: 560.891px; top: 1150.17px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00025);">unrolled, converted to ROP and the entry point before the</span><span dir="ltr" style="left: 539.052px; top: 1166.83px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00005);">original PE code</span><span dir="ltr" style="left: 72.1132px; top: 1186px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00036);">ROP exit</span><span dir="ltr" style="left: 275.558px; top: 1186px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00017);">the executable file is patched with the shellcode u</span><span dir="ltr" style="left: 568.305px; top: 1186px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00026);">nrolled, converted to ROP and the entry point before the</span><span dir="ltr" style="left: 444.798px; top: 1202.67px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00021);">original program's exit (hook ExitProcess or exit)</span><span dir="ltr" style="left: 72.1134px; top: 1221.83px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00012);">Shellcode entry (no-rop no-</span><span dir="ltr" style="left: 72.1134px; top: 1238.5px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999813);">unroll)</span><span dir="ltr" style="left: 289.638px; top: 1221.83px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.0002);">the executable file is patched with the shellcode intact a</span><span dir="ltr" style="left: 617.958px; top: 1221.83px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00021);">nd the entry point before the original PE code</span><span dir="ltr" style="left: 72.1134px; top: 1257.67px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.0001);">Shellcode exit (no-rop no-</span><span dir="ltr" style="left: 72.1134px; top: 1274.33px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999813);">unroll)</span><span dir="ltr" style="left: 273.185px; top: 1257.67px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.0002);">the executable file is patched with the shellcode intact a</span><span dir="ltr" style="left: 601.505px; top: 1257.67px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.0002);">nd the entry point before the original program's exit</span><span dir="ltr" style="left: 511.652px; top: 1274.33px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00029);">(hook ExitProcess or exit)</span><span dir="ltr" style="left: 70.8658px; top: 1320.58px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(0.999841);">574</span><span dir="ltr" style="left: 637.132px; top: 1320.58px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00354);">IET Inf. Secur.</span><span dir="ltr" style="left: 721.852px; top: 1320.58px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00037);">, 2019, Vol. 13 Iss. 6, pp. 570-578</span><span dir="ltr" style="left: 603.812px; top: 1338.92px; font-size: 13.3333px; font-family: sans-serif; transform: scaleX(1.00018);">© The Institution of Engineering and Technology 2019</span><div class="endOfContent"></div></div><div class="annotationLayer"><section data-annotation-id="37R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -192.33px -253.3px; left: 192.33px; top: 253.3px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A36%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C322.379%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="38R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -132.102px -273.3px; left: 132.102px; top: 273.3px; width: 9px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A80%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C657.09%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="39R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -111.513px -303.3px; left: 111.513px; top: 303.3px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A36%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C175.84%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="40R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -483.218px -85.3px; left: 483.218px; top: 85.3px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A36%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C322.379%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="41R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -379.113px -295.3px; left: 379.113px; top: 295.3px; width: 9px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A80%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C649.09%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="42R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -333.495px -305.3px; left: 333.495px; top: 305.3px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A36%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C322.379%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="43R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -466.71px -325.3px; left: 466.71px; top: 325.3px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A47%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C793.09%2Cnull%5D" class="internalLink"></a></section><section data-annotation-id="44R" class="linkAnnotation" style="transform: matrix(1.66667, 0, 0, 1.66667, 0, 0); transform-origin: -546.006px -345.3px; left: 546.006px; top: 345.3px; width: 4.5px; height: 9px;"><a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386#%5B%7B%22num%22%3A47%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2Cnull%2C793.09%2Cnull%5D" class="internalLink"></a></section></div></div><div class="page" data-page-number="6" role="region" style="width: 992px; height: 1403px;"><div class="loadingIcon" role="img"></div></div><div class="page" data-page-number="7" role="region" style="width: 992px; height: 1403px;"><div class="loadingIcon" role="img"></div></div><div class="page" data-page-number="8" role="region" style="width: 992px; height: 1403px;"><div class="loadingIcon" role="img"></div></div><div class="page" data-page-number="9" role="region" style="width: 992px; height: 1403px;"><div class="loadingIcon" role="img"></div></div></div></div></div></div></div>
            
        </div>
        <script type="text/javascript">
            var readerConfig = {"user":{"isLoggedIn":false,"loginLink":"/action/showLogin?redirectUri\u003d%2Fdoi%2Fepdf%2F10.1049%2Fiet-ifs.2018.5386","registerLink":"https://ietresearch.onlinelibrary.wiley.com/action/registration?redirectUri\u003d%2Fdoi%2Fepdf%2F10.1049%2Fiet-ifs.2018.5386"},"readingProgress":{"syncProgress":false,"syncUrl":"/reader/saveProgress","retrieveUrl":"/reader/retrieveProgress"},"doi":"10.1049/iet-ifs.2018.5386","title":"Transforming malicious code to ROP gadgets for antivirus evasion","epubConfig":{"overrideEpubUrlParam":true,"epubUrl":"/doi/pdfdirect/10.1049/iet-ifs.2018.5386?hmac\u003d7D15B9CAEA1D6BA3A22D5A0D115E65B0B71E219F95A5A52B383E65F898A35ABB"},"epubActions":{"offline":{"available":true,"fileSize":"1.7 MB","simultaneousRetrievalsLimit":1},"download":{"files":{"pdf":{"shortCode":"pdf","name":"PDF","available":true,"size":"1.7 MB","url":"/doi/pdfdirect/10.1049/iet-ifs.2018.5386?download\u003dtrue","doi":"10.1049/iet-ifs.2018.5386"}}},"print":true,"shareAccess":true,"preview":false,"rental":false,"print_pdf_pages":50},"displayOptions":{"displayFormat":"auto","displayMode":"scroll-continuous"},"annotationsConfig":{"enabled":false},"materialTabs":{"figuresSuppressed":false,"mediaSuppressed":true,"tablesSuppressed":true,"supplementsSuppressed":false,"linkOutUrl":"/doi/suppl/10.1049/iet-ifs.2018.5386","supplementsLinkOut":false,"openDownloadLinkInNewTab":false},"analyticsConfig":{"enabled":true,"providers":[{"enabled":true,"name":"atm","siteId":"","version":"","url":""}]},"waterMarkConfig":{"enabled":true,"defaultMessage":"17518717, 2019, 13, Downloaded from https://ietresearch.onlinelibrary.wiley.com. By Brandenburgische Technische- on XXX. Re-use and distribution is strictly not permitted, except for Open Access articles","optionalMessage":"","location":"right/left"},"metadataUrl":"/doi/reader/metadata/10.1049/iet-ifs.2018.5386","referencesUrl":"/doi/reader/references/10.1049/iet-ifs.2018.5386","citedByUrl":"/doi/reader/citedBy/10.1049/iet-ifs.2018.5386","figuresUrl":"/doi/reader/figures/10.1049/iet-ifs.2018.5386","tablesUrl":"/doi/reader/tables/10.1049/iet-ifs.2018.5386","mediaUrl":"/doi/reader/media/10.1049/iet-ifs.2018.5386","recommendationsUrl":"/doi/reader/recommended/10.1049/iet-ifs.2018.5386","siteUrl":"/doi/10.1049/iet-ifs.2018.5386","searchUrl":"/reader/search","currentUrl":"https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386","permissionsUrl":"/action/availableUsageRights","consumePermissionsUrl":"/action/consumeUsage","format":"pdf","publicationType":"article","citationsExportUrl":"/action/showCitFormats?doi\u003d10.1049%2Fiet-ifs.2018.5386\u0026mobileUi\u003d0","dbStoreName":"readerOfflineStore","shareAccessUrl":"/action/generateShareUrl","readerSettingsLocalStorageKey":"article_reader_settings","recommendedEnabled":true,"permissionsEnabled":false,"isDragAndDropEnabled":false,"isOfflineSupportedForBrowser":true,"isOfflineDisabled":false,"isDownloadDisabled":false,"isShareDisabled":false,"isPrintDisabled":false,"nodeNavigationDisabled":false,"navigationMode":"PAGEBREAK","usageRightsEnabled":true,"print_pdf_pages":0,"authorizeSharing":"/action/authorizeSharing","shareMode":false,"sharedAccessConfig":{"alwaysDisplaySharingTermsPopup":false,"shareSponsorLink":"https://onlinelibrary.wiley.com/researchers/tools-resources/sharing","shareSponsorMessage":"Some features may be limited or disabled","shareMediaMessage":"Some features may be limited or disabled","isShared":false,"isPermissionEnabled":false,"isShareBannerEnabled":false,"displayAccessButton":true,"accessUrl":"/doi/full/10.1049/iet-ifs.2018.5386"},"inDocAdsEnabled":true,"campaigns":"{}","suspendAdsInSinglePagePdfs":true,"adsImpressionDuration":0,"campaignUrl":"/action/showReaderCampaign?doi\u003d10.1049%2Fiet-ifs.2018.5386","eventsConfig":{"readerEventsAnalyticsUrl":"/action/readerEventsAnalytics?doi\u003d10.1049%2Fiet-ifs.2018.5386\u0026format\u003dpdf","adImpressionDuration":5000,"episodeRemainingTime":300000,"enabled":true,"allowedNumOfEventsPerReq":50,"excludedEvents":"read,openLeftMenu"},"content_buffer_size":2000,"isPrintSupportedForBrowser":true,"isMaterialDownloadable":true,"isEpubLazyLoadingEnabled":true,"isPdfLazyLoadingEnabled":true,"loadedPagesLimit":7,"maxPdfKeepSize":20,"switchFormats":{"enabled":false,"current":"pdf","available":{"pdf":{"name":"pdf","url":"/doi/epdf/10.1049/iet-ifs.2018.5386"}}},"supplementsUrl":"/action/showReaderSupplements?doi\u003d10.1049%2Fiet-ifs.2018.5386","tabsSuppressionConfig":{"materialsSuppressed":false,"notesSuppressed":true,"linksSuppressed":false,"infosSuppressed":false},"fetchFiguresFromEpub":false,"mediaPlayersConfig":{"enabled":false,"player":{"enabled":false,"name":"flowplayer","css":"//releases.flowplayer.org/6.0.5/commercial/skin/functional.css","key":"$471173155739872","playerScript":"//releases.flowplayer.org/6.0.5/flowplayer.min.js"}},"adsInclusionEnabled":true,"helpEnabled":false,"profileConfig":{"activeProfile":"DEFAULT","printSuppressed":false,"offlineSuppressed":false,"downloadSuppressed":false,"switchFormatsSuppressed":true,"materialsSuppressed":false,"notesSuppressed":true,"linksSuppressed":false,"infoSuppressed":false,"siteLinkOutSuppressed":false,"accessSharingSuppressed":false},"isReadingFlowEnabled":true,"showCrossmarkButton":false,"restrictContent":true,"restrictCopying":true,"isScitrusHelpGuideEnabled":false,"referencesNumberingSupported":true,"freeToReadConfig":{"learnMoreLink":"","bannerMessage":"Downloading and printing are disabled.","isFreeToRead":false,"isBannerEnabled":true,"isGetAccessButtonVisible":true,"accessUrl":"/doi/ftr/10.1049/iet-ifs.2018.5386"},"doiMappingConfig":{"enabled":false},"rendererData":{"src":"/cloud-reader/dist/pdf-renderer.js","cssSrc":"/cloud-reader/dist/pdf-renderer.css","templatesSrc":""},"fileSize":1741739,"faqLinkData":{"enabled":false},"pdfjsDisableStream":true,"pdfjsDefaultRangeChunkSize":262144,"termsAndConditionsUrl":"https://onlinelibrary.wiley.com/termsAndConditions"};
            readerConfig.contentCacheName = "readerPubPathsCache";
            readerConfig.libraryPath='/reader/library';
        </script>
        




<script type="text/javascript">
    
    readerConfig.alertPopupMsg = {
        
        PRINTING_DISABLED_MESSAGE : "<i class='material-icons'>info_outline</i> <h2>Do not print this page</h2> <h3>To view your printing options, return to the document and click the print option in the menu in the top right corner of the page.</h3>",
        
        USER_UNAUTHORIZED: "You do not have the required license. The publication cannot be <span>X</span>.",
        
        SHARING_DISABLED: "Sharing access to publications is not currently enabled.",
        SHARING_UNAUTHORIZED: "This content has license restrictions and cannot be shared via Shared Access.",
        SHARING_UNAVAILABLE: "This content has license restrictions and cannot be shared via Shared Access.",
        SHARING_TEMPORARY_ERROR: "<span>X</span> failed. Please try again."
    };

    LIT.Reader.config = {
        /* http://requirejs.org/docs/api.html#config-waitSeconds */
        waitSeconds: 0,
        config: {
            'readerConfig': {
                
                        'mathJaxUrl': HTTPServerRootFolder + '/MathJax.min.js',
                    
                'annotationCSSUrl': HTTPServerRootFolder + '/css/annotations.css',
                'iframeContentCSSUrl': '/cloud-reader/dist/iframe-content.css',
                'jsLibRoot': HTTPServerRootFolder + '/scripts/zip/',
                'useSimpleLoader': false,
                'epubLibraryPath': undefined,
                'imagePathPrefix': '/cloud-reader/src/',
                'canHandleUrl': false,
                'canHandleDirectory': false,
                'workerUrl': undefined,
                'epubReadingSystemUrl': undefined,
                "customConfig": readerConfig
            }
        }
    };
</script>


        
                <script type="text/javascript" src="./Transforming malicious code to ROP gadgetsfor antivirus evasion_files/templates.js"></script>
                
                <script type="text/javascript" src="./Transforming malicious code to ROP gadgetsfor antivirus evasion_files/vendor.js"></script>
                <script type="text/javascript" src="./Transforming malicious code to ROP gadgetsfor antivirus evasion_files/shared.js"></script>
                <script type="text/javascript" src="./Transforming malicious code to ROP gadgetsfor antivirus evasion_files/i18n.js"></script>
            
    
        
        
            
                    <script type="module">
                        if ('serviceWorker' in navigator && !window.READER_OFFLINE) {
                            window.addEventListener("load", function (evt) {
                                
                                var CACHE_BUSTER_MARKER = 5;

                                var assetsCacheName = 'readerAssetsCache-978247-' + CACHE_BUSTER_MARKER;
                                var readerContentUrl = window.location.pathname;
                                import ('/templates/jsp/cloudReader/js/readerServiceWorkerHelper.js').then(function (swHelper) {
                                    swHelper.registerServiceWorkers(true, readerContentUrl, readerContentPage, assetsCacheName, readerConfig.format);
                                });
                            });
                            
                            var readerContentPage = "<!DOCTYPE html>"+$('html')[0].outerHTML;
                        }
                    </script>
                
        
    <script type="text/javascript">(function(){window['__CF$cv$params']={r:'6df6bbdf8997452e',m:'Tkl3XnclNB2qYuzDltEYLlxSfXRcpD_Nd2RBBtr9cvs-1645181839-0-AeZyfc7pjqK82ZHrImYoXK8tGAnJyfc21xNP+70bijqm/32nzyOZuUJzZVygpYeAIZ/6HjXxP+BPFU+aFhO9uVaTSAcaQedXIvl6kICuLLXDuToZG3nQHQ9MbnRIlYa+HvKmcyUxCNXekdOuwG0o6Ko7HdCp5Q8Hi0BZ7Sz5Rmgo',s:[0x5d7a322bbf,0xb6e48ca978],}})();</script><script defer="" src="./Transforming malicious code to ROP gadgetsfor antivirus evasion_files/v652eace1692a40cfa3763df669d7439c1639079717194" integrity="sha512-Gi7xpJR8tSkrpF7aordPZQlW2DLtzUlZcumS8dMQjwDHEnw9I7ZLyiOj/6tZStRBGtGgN6ceN6cMH8z7etPGlw==" data-cf-beacon="{&quot;rayId&quot;:&quot;6df6bbdf8997452e&quot;,&quot;token&quot;:&quot;f3dd54df2ac243bab2129483f57546d1&quot;,&quot;version&quot;:&quot;2021.12.0&quot;,&quot;si&quot;:100}" crossorigin="anonymous"></script>


<div id="pdf-printContainer"></div><div class="material-viewer">
    <nav class="material-viewer_reg_top navbar" role="banner" aria-label="Toolbar">
        <div class="btn-group material-viewer_top_left">
            <div class="d-block d-md-none">
                <div class="element-view">
                    <div class="grouped">
                        <button class="btn material-viewer_ctrl_caption" title="Element menu" type="button" tabindex="0">
                            <span class="icon material-icons">sort</span>
                        </button>
                    </div>
                    <div class="grouped">
                        <!-- previous figure button -->
                        <button class="btn material-viewer_ctrl_prev" title="Previous" type="button" tabindex="0">
                            <span class="icon material-icons flip-horizontal">play_circle_filled</span>
                        </button>
                        <!-- next figure button -->
                        <button class="btn material-viewer_ctrl_next" title="Next" type="button" tabindex="0">
                            <span class="icon material-icons">play_circle_filled</span>
                        </button>
                    </div>
                </div>
                <div class="grid-view">
                    <button class="btn material-viewer_ctrl_return small" title="Return" type="button" tabindex="0">
                        <span class="icon material-icons">arrow_back</span>
                        <span class="text">BACK</span>
                    </button>
                </div>
            </div>

            <div class="grouped d-none d-md-block">
                <h2 class="material-viewer_title material-viewer_title_chapter" title="Chapter Title">chapter title
                    here</h2>
            </div>
        </div>

        <div class="btn-group material-viewer_top_center d-none d-md-flex">
            <div class="element-view flex-container">
                <div class="grouped">
                    <h2 class="material-viewer_title material-viewer_title_text" title="Element Title" tabindex="0">figure title
                        here</h2>
                </div>

                <div class="grouped download-toggle-hidden">
                    <a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386" target="_blank" class="btn media__download" title="Download element" download="" aria-label="download element" tabindex="0">
                        <span class="icon material-icons">get_app</span>
                    </a>
                </div>
            </div>

            <div class="grid-view">
                <div class="grouped dropdown-widget">
                    <button id="dropdownSort" class="dropdown-trigger btn" title="Select filtering" type="button" tabindex="0" aria-label="select filtering" aria-haspopup="true" aria-expanded="false">
                        <span class="sorting_title_selection"><span class="text">All Materials</span>&nbsp;(<span class="counter">0</span>)</span>
                        <span class="animated_arrow_down"></span>
                    </button>

                    <div class="dropdown-content materialViewer-sorting" aria-labelledby="dropdownSort">
                        <div class="panels" data-vport="767" data-panel-desktop="materialViewerSorting">
                            <fieldset class="sorting-list">
                                <legend class="d-block d-md-none">SHOW</legend>
                                <input type="radio" name="sorting-type" value="all" id="all-radio" class="on_light_bg" checked="">
                                <label for="all-radio">
                                    <span class="text">All materials</span>&nbsp;
                                    <span class="counter">0</span>
                                </label>

                                <input type="radio" name="sorting-type" value="figure" id="image-radio" class="on_light_bg">
                                <label for="image-radio">
                                    <span class="text">Figures</span>&nbsp;
                                    <span class="counter">0</span>
                                </label>

                                <input type="radio" name="sorting-type" value="table" id="table-radio" class="on_light_bg">
                                <label for="table-radio">
                                    <span class="text">Tables</span>&nbsp;
                                    <span class="counter">0</span>
                                </label>

                                <input type="radio" name="sorting-type" value="video" id="video-radio" class="on_light_bg">
                                <label for="video-radio">
                                    <span class="text">Videos</span>&nbsp;
                                    <span class="counter">0</span>
                                </label>

                                <input type="radio" name="sorting-type" value="audio" id="audio-radio" class="on_light_bg">
                                <label for="audio-radio">
                                    <span class="text">Audio files</span>&nbsp;
                                    <span class="counter">0</span>
                                </label>

                                <input type="radio" name="sorting-type" value="code" id="code-radio" class="on_light_bg">
                                <label for="code-radio">
                                    <span class="text">Code snippets</span>&nbsp;
                                    <span class="counter">0</span>
                                </label>

                                <input type="radio" name="sorting-type" value="supplement" id="supplements-radio" class="on_light_bg">
                                <label for="supplements-radio">
                                    <span class="text">Other files</span>&nbsp;
                                    <span class="counter">0</span>
                                </label>
                            </fieldset>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="btn-group material-viewer_top_right">
            <div class="grouped element-view material-viewer_zoom d-none d-md-inline-flex">

                <button class="btn zoom-fit width" title="Fit Width" aria-label="fit width">
                    <span class="icon material-icons">fullscreen</span>
                </button>

                    <button class="btn zoom-fit height d-none" title="Fit Height" aria-label="fit height">
                        <span class="icon material-icons">fullscreen_exit</span>
                    </button>

                <!-- ZOOM OUT button -->
                <button class="zoom-out btn" title="Zoom Out" type="button" tabindex="0" aria-label="zoon out">
                    <span class="icon material-icons">remove_circle_outline</span>
                </button>
                <!-- ZOOM IN  button -->
                <button class="zoom-in btn" title="Zoom In" type="button" tabindex="0" aria-label="zoom in">
                    <span class="icon material-icons">add_circle_outline</span>
                </button>
            </div>

            <div class="grouped material-viewer_navigation d-none d-md-inline-flex">
                <!-- previous figure button -->
                <button class="btn material-viewer_ctrl_prev" title="Previous" type="button" tabindex="0" aria-label="previous figure">
                    <span class="icon material-icons flip-horizontal">play_circle_filled</span>
                </button>
                <!-- next figure button -->
                <button class="btn material-viewer_ctrl_next" title="Next" type="button" tabindex="0" aria-label="next figure">
                    <span class="icon material-icons">play_circle_filled</span>
                </button>
            </div>

            <div class="grouped">
                <div class="element-view">
                    <button class="btn material-viewer_ctrl_browse" title="Browse all elements" type="button" tabindex="0" aria-label="browse all elements">
                        <span class="icon reader-material-gallery"></span>
                    </button>
                </div>

                <div class="grid-view">
                    <div class="d-none d-md-inline-block">
                        <button class="btn material-viewer_ctrl_return small" title="Return" type="button" tabindex="0" aria-label="return">
                            <span class="icon material-icons">arrow_back</span>
                            <span class="text">BACK</span>
                        </button>
                    </div>
                    <div class="d-block d-md-none">
                        <button class="btn material-viewer_ctrl_sorting" title="Browse sorting options" type="button" tabindex="0" aria-label="browse sorting options">
                            <span class="icon reader-filter"></span>
                        </button>
                    </div>
                </div>
            </div>

            <div class="grouped">
                <button class="btn material-viewer_ctrl_close small" title="Close viewer" type="button" tabindex="0" data-tooltip-position="bottom" browse="" sorting="" options="">
                    CLOSE
                </button>
            </div>
        </div>
    </nav>

    <div class="material-viewer_reg_center">
        <div class="material-viewer_cent_left js-open">
            <button class="material-viewer_ctrl_caption toggle_sidebar_button btn btn--aside d-none d-md-inline-flex" title="Toggle element details" type="button" tabindex="0" aria-label="toggle element details">
                <span class="icon reader-double-arrow flip-horizontal"></span>
            </button>
            <div class="material-viewer_figCaption">
                <div class="material-viewer_figCaption_top">
                    <h3 class="subheader material-viewer_title_text" tabindex="0">figure title here</h3>
                    <div class="fig-download d-md-none">
                        <a href="https://ietresearch.onlinelibrary.wiley.com/doi/epdf/10.1049/iet-ifs.2018.5386" target="_blank" class="btn media__download" title="Download element" role="link" download="" tabindex="0">
                            <span class="icon material-icons">get_app</span>
                        </a>
                    </div>
                </div>
                <div id="caption-tab-pane">
                    <div class="paddedPane mediumText js__caption" tabindex="0"></div>
                </div>
            </div>
        </div>

        <div class="material-viewer_cent_center js-open">
            <div class="material-viewer_hold_fig">
                <figure class="holder"></figure>
            </div>
            <div class="material-viewer_hold_list"></div>
        </div>

        <div class="material-viewer_cent_right">
            <div class="scrollingContainer">
                <h3 class="subTitle sorting_title_selection">All Materials</h3>
                <h4 class="mediumText d-block d-md-none material-viewer_title_chapter" title="Publication Title">publication
                    title here</h4>
                <div class="panels" data-vport="767" data-panel-mobile="materialViewerSorting"></div>
            </div>
        </div>
    </div>
</div>
</body></html>